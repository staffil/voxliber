{% extends "base.html" %}
{% load static i18n %}

{% block title %}ìƒˆ ìŠ¤í† ë¦¬ ë§Œë“¤ê¸° - VOXLIBER{% endblock %}

{% block extra_head %}

{% endblock %}

{% block content %}
<br><br><br><br>

<main class="story-create-container">

  <h1>ìƒˆ ìŠ¤í† ë¦¬ ë§Œë“¤ê¸°</h1>

  <form method="POST" action="{% url 'character:make_ai_story' %}" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- ìŠ¤í† ë¦¬ ì œëª© -->
    <div class="form-group">
      <label for="title">ìŠ¤í† ë¦¬ ì œëª©</label>
      <input 
        type="text" 
        name="title" 
        id="title" 
        placeholder="ì˜ˆ: í™©í˜¼ì˜ ê²€ê°, ë³„ì´ ì§€ëŠ” ë°¤" 
        required 
        maxlength="200" data-login-required
      >
      <small>ìŠ¤í† ë¦¬ ì „ì²´ë¥¼ ëŒ€í‘œí•˜ëŠ” ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</small>
    </div>

    <!-- ìŠ¤í† ë¦¬ ì„¤ëª… -->
    <div class="form-group">
      <label for="description">ìŠ¤í† ë¦¬ ì„¤ëª… (ì„ íƒ)</label>
      <textarea 
        name="description" 
        id="description" 
        rows="5" 
        placeholder="ì´ ìŠ¤í† ë¦¬ì˜ ë°°ê²½, ë¶„ìœ„ê¸°, ì£¼ìš” í…Œë§ˆ ë“±ì„ ê°„ë‹¨íˆ ì ì–´ì£¼ì„¸ìš”. ë‚˜ì¤‘ì— ìºë¦­í„°ë¥¼ ë§Œë“¤ ë•Œ ì°¸ê³ ë©ë‹ˆë‹¤." data-login-required
      ></textarea>
      <small>AIê°€ ìŠ¤í† ë¦¬ë¥¼ ë” ì˜ ì´í•´í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤ë‹ˆë‹¤.</small>
    </div>

    <!-- í‘œì§€ ì´ë¯¸ì§€ -->
    <div class="form-group">
      <label for="cover_image">í‘œì§€ ì´ë¯¸ì§€ (ì„ íƒ)</label>
      <input type="file" name="cover_image" accept="image/*" id="cover_image" data-login-required>
      <small>ìŠ¤í† ë¦¬ ëª©ë¡ì´ë‚˜ ìƒì„¸ í˜ì´ì§€ì— í‘œì‹œë  ì´ë¯¸ì§€ì…ë‹ˆë‹¤.</small>
    </div>

    
    <div class="info-card">
        <label class="info-label">ğŸ­ ì¥ë¥´ ì„ íƒ (ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥)</label>
        <div class="genre-grid">
            {% for genre in genre_list %}
            <label class="genre-option">
                <input type="checkbox" name="genres" value="{{ genre.id }}"
                    {% if book and genre in book.genres.all %}checked{% endif %} data-login-required>
                <span class="genre-box" style="background-color: {{ genre.genres_color|default:'#FFF' }}">
                    {{ genre.name }}
                </span>
            </label>
            {% endfor %}
        </div>
    </div>

    <!-- íƒœê·¸ ê²€ìƒ‰/ì¶”ê°€ -->
    <div class="info-card">
        <label class="info-label">ğŸ·ï¸ íƒœê·¸ ì„ íƒ</label>
        <div class="tag-input-wrapper">
            <input type="text" id="tag-search" placeholder="íƒœê·¸ ê²€ìƒ‰ ë˜ëŠ” ì¶”ê°€..." data-login-required>
            <button type="button" id="add-tag-btn">ì¶”ê°€</button>
        </div>

        <div class="selected-tags" id="selected-tags">
            {% for tag in book.tags.all %}
            <input type="hidden" name="tags" value="{{ tag.id }}" data-login-required>
            <span class="selected-tag">{{ tag.name }}</span>
            {% endfor %}
        </div>

        <div class="tag-list-wrapper">
            <div class="tag-grid" id="tag-grid">
                {% for tag in tag_list %}
                <label class="tag-option">
                    <input type="checkbox" class="tag-checkbox" value="{{ tag.id }}"
                        {% if book and tag in book.tags.all %}checked{% endif %} data-login-required>
                    <span>{{ tag.name }}</span>
                </label>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- ì œì¶œ ë²„íŠ¼ -->
    <button type="submit" class="submit-btn" data-login-required>ìŠ¤í† ë¦¬ ë§Œë“¤ê³  ìºë¦­í„° ì¶”ê°€í•˜ê¸° â†’</button>

  </form>

</main>

{% endblock %}


{% block extra_js %}
{% endblock %}
