
{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ snap.snap_title }} - VOXLIBER ì‡¼ì¸ </title>
<link rel="stylesheet" href="{% static 'css/book/snap/snap_detail.css' %}">
</head>
<body>
    <!-- ë©”ì¸ ì‡¼ì¸  ì»¨í…Œì´ë„ˆ -->
    <div class="shorts-container">
        <!-- ìƒë‹¨ í—¤ë” -->
        <div class="shorts-header">
            <div class="header-left">
                <a href="/" style="text-decoration: none;">
                    <div class="logo">VOXLIBER</div>
                </a>
                <div class="shorts-badge">SNAP</div>
            </div>
            <button class="close-btn" onclick="window.location.href='/'">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>

        <!-- ë¹„ë””ì˜¤ ì˜ì—­ -->
        <div class="video-wrapper" id="videoWrapper">
            {% if snap.snap_video %}
                <video id="mainVideo" playsinline loop>
                    <source src="{{ snap.snap_video.url }}" type="video/mp4">
                </video>
                <div class="play-overlay visible" id="playOverlay">
                    <div class="play-icon">â–¶</div>
                </div>
                <div class="video-controls">
    <div class="time-display" id="timeDisplay">00:00 / 00:00</div>

    <div class="seekbar-container">
        <input type="range" id="seekBar" min="0" max="100" value="0" data-login-required>
    </div>
</div>
            {% elif snap.snap_image %}
                <img src="{{ snap.snap_image.url }}" alt="{{ snap.snap_title }}">
            {% elif snap.thumbnail %}
                <img src="{{ snap.thumbnail.url }}" alt="{{ snap.snap_title }}">
            {% else %}
                <div style="text-align: center; color: rgba(255,255,255,0.5);">
                    <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“–</div>
                    <div>ë¯¸ë””ì–´ê°€ ì—†ìŠµë‹ˆë‹¤</div>
                </div>
            {% endif %}
        </div>

<!-- ì˜¤ë¥¸ìª½ ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
<div class="actions-panel">
    <!-- ì¢‹ì•„ìš” -->
    <div class="action-btn" id="likeBtn" data-snap-id="{{ snap.id }}" data-login-required>
        <div class="action-icon" id="likeIcon">
            {% if user in snap.booksnap_like.all %}
                â¤ï¸
            {% else %}
                ğŸ¤
            {% endif %}
        </div>
<div class="action-count" id="likeCount">{{ snap.booksnap_like.count }}</div>
    </div>

    <!-- ëŒ“ê¸€ -->
    <div class="action-btn" id="commentBtn" data-snap-id="{{ snap.id }}" data-login-required>
        <div class="action-icon">ğŸ’¬</div>
        <div class="action-count">{{ comments.count }}</div>
    </div>

    <!-- ê³µìœ  -->
    <div class="action-btn" id="shareBtn" data-login-required>
        <div class="action-icon">ğŸ”—</div>
        <div class="action-count">ê³µìœ </div>
    </div>

    <!-- ì¡°íšŒìˆ˜ -->
    <div class="action-btn" id="viewBtn" data-snap-id="{{ snap.id }}" data-login-required>
        <div class="action-icon">ğŸ‘ï¸</div>
        <div class="action-count" id="viewCount">{{ snap.views|default:0 }}</div>
    </div>
</div>


        <!-- í•˜ë‹¨ ì •ë³´ ì˜ì—­ -->
        <div class="info-panel">
            <div class="author-info">
                <div class="author-avatar">
                    {% if snap.user.user_img %}
                        <img src="{{ snap.user.user_img.url }}" alt="{{ snap.user.nickname }}">
                    {% else %}
                        {{ snap.user.nickname|slice:":1"|upper }}
                    {% endif %}
                </div>
                <div class="author-name">{{ snap.user.nickname }}</div>

            </div>
            <div class="snap-title">{{ snap.snap_title }}</div>
            <div class="snap-description">{{ snap.book_comment }}</div>
<a href="{{ snap.book_link }}" class="arrow-link" data-login-required>ì±… ë³´ëŸ¬ ê°€ê¸°</a>
        </div>


    </div>

    <!-- ëŒ“ê¸€ íŒ¨ë„ -->
    <div class="comments-panel" id="commentsPanel">
        <div class="comments-header">
            <div class="comments-title">ëŒ“ê¸€ {{ comments.count }}ê°œ</div>
            <button class="close-btn" onclick="toggleComments()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="comments-list" id="commentsList">
            {% for comment in comments %}
                <div class="comment-item">
                    <div class="comment-author">{{ comment.user.nickname }}</div>
                    <div class="comment-text">{{ comment.content }}</div>
                    <div class="comment-time">{{ comment.created_at|timesince }} ì „</div>
                </div>
            {% empty %}
                <div style="text-align: center; color: rgba(255,255,255,0.5); padding: 40px 20px;">
                    ì²« ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!
                </div>
            {% endfor %}
        </div>
        {% if user.is_authenticated %}
            <div class="comment-input-wrapper">
                <input type="text" class="comment-input" id="commentInput" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleCommentKeyPress(event)" data-login-required>
            </div>
        {% endif %}
    </div>
{% block extra_js %}
<script>
    const snapId = '{{ snap.public_uuid }}';
const prevSnapId = '{{ prev_snap_uuid|default:"null" }}';
const nextSnapId = '{{ next_snap_uuid|default:"null" }}';
const video = document.getElementById('mainVideo');
const playOverlay = document.getElementById('playOverlay');
const videoWrapper = document.getElementById('videoWrapper');
const closeCommentsBtn = document.querySelector('#commentsPanel .close-btn');
const likeBtn = document.getElementById('likeBtn');
const viewBtn = document.getElementById('viewBtn');
const seekBar = document.getElementById("seekBar");
const timeDisplay = document.getElementById("timeDisplay");
</script>
<script src="{% static 'js/book/snap/snap_detail.js' %}"></script>


{% endblock %}
</body>
</html>
