{% extends "base.html" %}
{% load static %}

{% block title %}VOXLIBER - ëª©ì†Œë¦¬ë¡œ ë“£ëŠ” ì´ì•¼ê¸°{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home/main/audio.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/banner.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/common.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/main.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/poem.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/ranking.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/recent.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/resume.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/snap.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/snippet.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/spotlight.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/genres.css' %}">
{% endblock %}

{% block content %}
<div class="main-container">
  <!-- ë©”ì¸ ì½˜í…ì¸  ë˜í¼ -->
  <div class="main-content-wrapper">
<div class="promo-container-wrapper">
  <!-- ìŠ¬ë¼ì´ë” -->
  <!-- <div class="promo-container">
      {% for advertisment in advertisment_list %}
      <div class="promo-banner">
          <a href="{{ advertisment.link }}">
              <img src="{{ advertisment.advertisment_img.url }}" alt="ì´ë²¤íŠ¸" loading="lazy">
          </a>
      </div>
      {% endfor %}
  </div>

  <button class="promo-nav promo-nav-prev" id="promoPrev" title="ì´ì „ ê´‘ê³ ">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
    </svg>
  </button>

  <button class="promo-nav promo-nav-next" id="promoNext" title="ë‹¤ìŒ ê´‘ê³ ">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
      <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
    </svg>
  </button>

  <div class="promo-controls">
    <div class="promo-counter">
      <span id="currentSlide">1</span> / <span id="totalSlides">{{ advertisment_list|length }}</span>
    </div>

    <button class="promo-play-pause" id="promoPlayPause" title="ì¼ì‹œì •ì§€">
      <svg id="pauseIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
      </svg>
      <svg id="playIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
        <path d="M8 5v14l11-7z"/>
      </svg>
    </button>

    <div class="promo-indicators">
        {% for advertisment in advertisment_list %}
            <span class="indicator"></span>
        {% endfor %}
    </div>
  </div>
</div>
 -->

  <!-- 
<br>
<div class="menu-grid">
  <div class="menu-circle">
    <a href="/book/book-snap/">
                <img src="{% static 'img/menu_snap.png' %}" alt="ìŠ¤ëƒ…">
    </a>
    <span>SNAP</span>
  </div>

  <div class="menu-circle event-btn">
    <a href="event/">
      <img src="{% static 'img/menu_event.png' %}" alt="ìŠ¤ëƒ…">

    </a>
    <span>ì´ë²¤íŠ¸</span>
  </div>
  <div class="menu-circle">
    <a href="poem_winner/">
            <img src="{% static 'img/menu_poem.png' %}" alt="ìŠ¤ëƒ…">

    </a>
    <span>ì‹œ ê³µëª¨ì „</span>
  </div>
<div class="menu-circle">
    <a href="#" >
                        <img src="{% static 'img/menu_kid.png' %}" alt="ìŠ¤ëƒ…">

    </a>
    <span>ë³µìŠ¤í‚¤ì¦ˆ</span>
  </div> 
  <div class="menu-circle">
    <a href="snippet_all/">
                  <img src="{% static 'img/menu_snippet.png' %}" alt="ìŠ¤ëƒ…">

    </a>
    <span>ë¶ ìŠ¤ë‹ˆí«</span>
  </div>

  <div class="menu-circle">
    <a href="/new_books/">
                              <img src="{% static 'img/menu_audioBook.png' %}" alt="ìŠ¤ëƒ…">

    </a>
    <span>ë¶ ë‘˜ëŸ¬ë³´ê¸°</span>
  </div>


</div>
-->

<section class="hero-section">
  <div class="hero-background">
    {% for news in news_list %}
      {% if news.news_img %}
        <img src="{{ news.news_img.url }}" alt="VOXLIBER" loading="lazy">
      {% else %}
        <img src="{% static 'images/default-banner.jpg' %}" alt="VOXLIBER" loading="lazy">
      {% endif %}
    {% empty %}
      <img src="{% static 'images/default-banner.jpg' %}" alt="VOXLIBER" loading="lazy">
    {% endfor %}
  </div>

  <div class="hero-overlay" style="border-radius: 15px;"></div>

  <div class="hero-content">
    <h1 class="hero-title">ëª©ì†Œë¦¬ë¡œ ë“£ëŠ” ì´ì•¼ê¸°</h1>
    <p class="hero-subtitle">AIê°€ ë§Œë“œëŠ” ì˜¤ë””ì˜¤ë¶ìœ¼ë¡œ ìƒˆë¡œìš´ ë…ì„œ ê²½í—˜ì„ ì‹œì‘í•˜ì„¸ìš”</p>

    {% if user.is_authenticated %}
      <!-- ë¡œê·¸ì¸ í–ˆìœ¼ë©´ ì‘í’ˆ ë§Œë“¤ê¸° ë²„íŠ¼ -->
      <a href="{% url 'book:book_tos' %}" class="hero-cta">
        <span>ì‘í’ˆ ë§Œë“¤ê¸°</span>
        <span>â†’</span>
      </a>
    {% else %}
      <!-- ë¡œê·¸ì¸ ì•ˆ í–ˆìœ¼ë©´ ë¡œê·¸ì¸ ì¹´ë“œ -->
      <div class="login-card">

            <a href="book/book_tos/" class="hero-cta" onclick="openLogin(); return false;" >
          <span>ì‘í’ˆ ë§Œë“¤ê¸°</span>
          <span>â†’</span>
        </a>
      </div>
    {% endif %}

  </div>
</section>





    <!-- ìµœê·¼ ë³¸ ì†Œì„¤ -->
{% if request.user.is_authenticated %}
<section class="content-section recent-section">
  <div class="section-header">
    <h2 class="section-title">
      <span class="title-icon">ğŸ“š</span>
      ìµœê·¼ ë³¸ ì‘í’ˆ
    </h2>
  </div>

  <div class="recent-books-carousel">
    {% for progress in recent_books %}
<div class="recent-book-card-wrapper">
  <a href="{% if progress.current_content %}{% url 'book:content_detail' progress.current_content.id %}{% else %}{% url 'book:book_detail' progress.book.id %}{% endif %}" class="recent-book-card">
    <div class="recent-cover">
      {% if progress.book.cover_img %}
        <img src="{{ progress.book.cover_img.url }}" alt="{{ progress.book.name }}" loading="lazy">
      {% else %}
        <div class="recent-placeholder">ğŸ“–</div>
      {% endif %}
      {% with first_episode=progress.book.contents.first %}
        {% if first_episode and first_episode.audio_file %}
        <button class="preview-audio-btn recent-preview"
                data-audio="{{ first_episode.audio_file.url }}"
                data-title="{{ progress.book.name }} - 1í™”"
                data-cover="{% if progress.book.cover_img %}{{ progress.book.cover_img.url }}{% endif %}" >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5v14l11-7z"/>
          </svg>
        </button>
        {% endif %}
      {% endwith %}
      <!-- <div class="recent-progress">
        <div class="progress-bar" style="width: {{ progress.progress_percentage }}%"></div>
      </div> -->
    </div>
    <div class="recent-info">
      <h4>{{ progress.book.name }}</h4>
    </div>
  </a>
</div>

    
    {% empty %}
    <div class="empty-state">ìµœê·¼ ë³¸ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤</div>
    {% endfor %}
  </div>
</section>

{% endif %}

    <!-- ì´ì–´ë“£ê¸° ì„¹ì…˜ -->
{% if request.user.is_authenticated and recent_listening %}
<section class="content-section continue-listening-section">
  <div class="section-header">
    <h2 class="section-title">
      <span class="title-icon">â–¶ï¸</span>
      ì´ì–´ë“£ê¸°
    </h2>
  </div>

  <div class="continue-listening-grid">
    {% for history in recent_listening %}
    <div class="continue-card">
      <div class="continue-cover">
        {% if history.book.cover_img %}
          <img src="{{ history.book.cover_img.url }}" alt="{{ history.book.name }}" loading="lazy">
        {% else %}
          <div class="continue-placeholder">ğŸ§</div>
        {% endif %}

        <!-- ì´ì–´ë“£ê¸° ë²„íŠ¼ -->
        <button class="resume-play-btn"
                data-content-url="{% url 'book:content_detail' history.content.id %}"
                data-position="{{ history.last_position }}">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M8 5v14l11-7z"/>
          </svg>
          <span>ì´ì–´ë“£ê¸°</span>
        </button>
      </div>

      <div class="continue-info">
        <h4 class="continue-title">{{ history.book.name }}</h4>
        <p class="continue-episode">{{ history.content.number }}í™”. {{ history.content.title }}</p>
        <div class="continue-progress-info">
          <span class="resume-time" data-seconds="{{ history.last_position }}">{{ history.last_position|floatformat:0 }}ì´ˆ</span>
          <span style="color: #666;">Â·</span>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}


    <!-- íˆì–´ë¡œ ì„¹ì…˜ -->
    <!-- <section class="hero-section">
      <div class="hero-background">
        {% for news in news_list %}
          {% if news.news_img %}
            <img src="{{ news.news_img.url }}" alt="VOXLIBER" loading="lazy">
          {% else %}
            <img src="{% static 'images/default-banner.jpg' %}" alt="VOXLIBER" loading="lazy">
          {% endif %}
        {% empty %}
          <img src="{% static 'images/default-banner.jpg' %}" alt="VOXLIBER" loading="lazy">
        {% endfor %}
      </div>
      <div class="hero-overlay" style="border-radius: 15px;"></div>
      <div class="hero-content">
        <h1 class="hero-title">ëª©ì†Œë¦¬ë¡œ ë“£ëŠ” ì´ì•¼ê¸°</h1>
        <p class="hero-subtitle">AIê°€ ë§Œë“œëŠ” ì˜¤ë””ì˜¤ë¶ìœ¼ë¡œ ìƒˆë¡œìš´ ë…ì„œ ê²½í—˜ì„ ì‹œì‘í•˜ì„¸ìš”</p>
        <a href="book/book-snap/" class="hero-cta">
          <span>ì‘í’ˆ ë‘˜ëŸ¬ë³´ê¸°</span>
          <span>â†’</span>
        </a>
      </div>
    </section> -->

<!-- ì‹œ ì‘ëª¨ì‘ winner - Slider -->
   <!-- 
<section class="poem-section">
  <h2 class="section-title">ğŸ† ì‹œ ì‘ëª¨ì‘ ìš°ìŠ¹ì‘</h2>

  <div class="poem-slider-wrapper">
    <div class="poem-slider">
      {% for poem in poem_list|slice:":10" %}
      <div class="poem-slide">
        {% if poem.image %}
        <img src="{{ poem.image.url }}" alt="{{ poem.title }}" class="poem-slide-bg" loading="lazy">
        {% else %}
        <div class="poem-slide-bg" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
        {% endif %}
        <div class="poem-slide-overlay"></div>
        <div class="poem-slide-content">
          <h3>{{ poem.title }}</h3>
          <div class="poem-text">{{ poem.content|linebreaksbr }}</div>
          {% if poem.poem_audio %}
          <div class="poem-audio-player">
            <button onclick="togglePoemSlideAudio(this)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            <div class="poem-audio-progress">
              <div class="poem-audio-bar">
                <div class="poem-audio-bar-fill"></div>
              </div>
              <div class="poem-audio-time">
                <span>0:00</span>
                <span>0:00</span>
              </div>
            </div>
            <audio src="{{ poem.poem_audio.url }}" preload="metadata"></audio>
          </div>
          {% endif %}
        </div>
      </div>
      {% empty %}
      <div class="poem-slide">
        <div class="poem-slide-bg" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
        <div class="poem-slide-overlay"></div>
        <div class="poem-slide-content">
          <p>í˜„ì¬ ìš°ìŠ¹ì‘ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
      </div>
      {% endfor %}
    </div>

    <button class="poem-nav poem-nav-prev" id="poemPrev" title="ì´ì „ ì‹œ">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
      </svg>
    </button>
    <button class="poem-nav poem-nav-next" id="poemNext" title="ë‹¤ìŒ ì‹œ">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
      </svg>
    </button>

    <div class="poem-controls">
      <div class="poem-counter">
        <span id="poemCurrentSlide">1</span> / <span id="poemTotalSlides">{{ poem_list|length }}</span>
      </div>

      <button class="poem-play-pause" id="poemPlayPause" title="ì¼ì‹œì •ì§€">
        <svg id="poemPauseIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
        </svg>
        <svg id="poemPlayIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
          <path d="M8 5v14l11-7z"/>
        </svg>
      </button>

      <div class="poem-indicators">
        {% for poem in poem_list|slice:":10" %}
        <span class="indicator"></span>
        {% endfor %}
      </div>
    </div>
  </div>
</section>
-->


<div class="snap-reels-section">
    <h3 class="snap-reels-title">ğŸ“¸ ë¶ìŠ¤ëƒ… ë¯¸ë¦¬ë³´ê¸°</h3>

    <div class="snap-reels-wrapper">
        {% for snap in snap_list %}
        <div class="snap-reels-item">
            <a href="{% url 'book:book_snap_detail' snap.id %}">
                <div class="snap-reels-media" style="position: relative; overflow: hidden;">

                    <!-- ì„¬ë„¤ì¼ ì´ë¯¸ì§€ -->
                    {% if snap.thumbnail %}
                        <img class="snap-thumbnail lazy-img"
                             data-src="{{ snap.thumbnail.url }}"
                             alt="{{ snap.snap_title }}"
                             loading="lazy"
                             style="width:100%; display:block;">
                    {% else %}
                        <img class="snap-thumbnail lazy-img"
                             data-src="{% static 'images/book_snap_placeholder.png' %}"
                             alt="{{ snap.snap_title }}"
                             loading="lazy"
                             style="width:100%; display:block;">
                    {% endif %}

                    <!-- ì˜ìƒ -->
                    {% if snap.snap_video %}
                        <video class="hover-preview-video"
                               muted
                               playsinline
                               preload="none"
                               data-src="{{ snap.snap_video.url }}"
                               style="position:absolute; top:0; left:0; width:100%; height:100%; display:none;">
                        </video>
                    {% endif %}

                    <div class="snap-reels-overlay">
                        {{ snap.snap_title|default:"ì œëª© ì—†ìŒ" }}
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const lazyVideos = document.querySelectorAll("video.hover-preview-video");
    const lazyImages = document.querySelectorAll("img.lazy-img");

    // IntersectionObserver: lazy load
    const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                if (entry.target.tagName === "VIDEO") {
                    entry.target.src = entry.target.dataset.src;
                }
                if (entry.target.tagName === "IMG") {
                    entry.target.src = entry.target.dataset.src;
                }
                obs.unobserve(entry.target);
            }
        });
    }, { threshold: 0.2 });

    lazyVideos.forEach(video => observer.observe(video));
    lazyImages.forEach(img => observer.observe(img));

    // Hover preview: ì„¬ë„¤ì¼ ìœ„ ì˜ìƒ 10ì´ˆ ì¬ìƒ
    lazyVideos.forEach(video => {
        const container = video.parentElement;
        const thumbnail = container.querySelector(".snap-thumbnail");
        let hoverTimeout;

        container.addEventListener("mouseenter", () => {
            if (!video.src) video.src = video.dataset.src;
            thumbnail.style.display = "none";
            video.style.display = "block";
            video.currentTime = 0;
            video.play();

            hoverTimeout = setTimeout(() => {
                video.pause();
                video.style.display = "none";
                thumbnail.style.display = "block";
            }, 10000);
        });

        container.addEventListener("mouseleave", () => {
            clearTimeout(hoverTimeout);
            video.pause();
            video.style.display = "none";
            thumbnail.style.display = "block";
        });
    });
});
</script>
<!-- ë¶ ìŠ¤ë‹ˆí« ëœë¤ ì¹´ë“œ -->

  <!-- 
<section class="snippet-section">
  <h2>ğŸ“– ëœë¤ ë¶ ìŠ¤ë‹ˆí«</h2>
  <div class="snippet-grid">
    {% for snippet in snippet_list|slice:":10" %}
    <div class="snippet-card">
      
      {% if snippet.book.cover_img %}
      <img src="{{ snippet.book.cover_img.url }}" alt="{{ snippet.book.name }}" class="snippet-card-bg" loading="lazy">
      {% else %}
      <div class="snippet-card-bg" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
      {% endif %}
      <div class="snippet-card-overlay"></div>
      
      <div class="snippet-card-content">
                   <p class="snippet-meta">{{ snippet.book.name }}</p>

        <div class="snippet-text">{{ snippet.sentence }}</div>
        
        <div class="snippet-bottom">
          {% if snippet.audio_file %}
          <div class="snippet-audio-player">
            <button onclick="toggleSnippetAudio(this)">
              <svg width="32" height="32" viewBox="0 0 24 24">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            <audio src="{{ snippet.audio_file.url }}" preload="metadata"></audio>
          </div>
          {% endif %} 
        </div>
        <a href="{{ snippet.link }}" style="text-decoration: none; color:rgb(255, 255, 255); font-size: 10px; margin-left: auto;">ì±… ë³´ëŸ¬ê°€ê¸°-></a>
      </div>

    </div>

    {% empty %}
    <p style="padding: 0 2rem;">í˜„ì¬ ëœë¤ ìŠ¤ë‹ˆí«ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endfor %}
  </div>
</section>
-->

   <!-- ìµœê³  í‰ì  ì‘í’ˆ ì„¹ì…˜ -->
    <!--
    <section class="content-section">
      <div class="section-header">
        <h2 class="section-title">ìµœê³  í‰ì  ì‘í’ˆ</h2>
      </div>

      <div class="books-grid">
        {% for book in popular_books|slice:":6" %}
        <div class="book-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="book-item">
            <div class="book-cover-wrapper">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
              <div class="book-badge">â­ {{ book.book_score }}</div>
            </div>
            <div class="book-details">
              <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h3>
              <p class="book-meta">
                {% for genre in book.genres.all|slice:":2" %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
                â€¢ {{ book.contents.count }}í™”
              </p>
              {% if book.tags.exists %}
              <p class="book-tags" style="margin-top: 4px; font-size: 0.7em; color: #6366f1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {% for tag in book.tags.all|slice:":5" %}
                  #{{ tag.name }}{% if not forloop.last %} {% endif %}
                {% endfor %}
              </p>
              {% endif %}
            </div>
          </a>
          {% with first_episode=book.contents.first %}
            {% if first_episode and first_episode.audio_file %}
            <button class="preview-audio-btn grid-preview"
                    data-audio="{{ first_episode.audio_file.url }}"
                    data-title="{{ book.name }} - 1í™”"
                    data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            {% endif %}
          {% endwith %}
        </div>
        {% empty %}
        <div class="empty-state">ì•„ì§ ë“±ë¡ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤</div>
        {% endfor %}
      </div>
    </section>
-->

    <!-- ì˜¤ëŠ˜ì˜ ì¶”ì²œ ì‘í’ˆ -->
<!-- ì˜¤ëŠ˜ì˜ ì¶”ì²œ ì‘í’ˆ -->
<section class="content-section spotlight-section">
  <div class="section-header">
    <h2 class="section-title">âœ¨ ì˜¤ëŠ˜ì˜ ì¶”ì²œ</h2>
  </div>

  <div class="scroll-container">
    <div class="spotlight-grid">
      {% for book in new_books|slice:":8" %}
      <div class="spotlight-card">
        <a href="{% url 'book:book_detail' book.id %}" class="spotlight-link">
          <div class="spotlight-thumb">
            {% if book.cover_img %}
              <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
            {% else %}
              <div class="spotlight-placeholder">ğŸ“š</div>
            {% endif %}
          </div>
          <div class="spotlight-info">
            <h3 class="spotlight-name">{{ book.name }}</h3>
            <p class="spotlight-writer">{{ book.user.nickname }}</p>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- ì¸ê¸° ìˆœìœ„ -->
  <div class="section-header" style="margin-top: 5rem;">
    <h2 class="section-title">ğŸ”¥ ì˜¤ëŠ˜ì˜ ì¸ê¸° ì˜¤ë””ì˜¤ë¶</h2>
  </div>

  <div class="ranking-container">
    {% for book in popular_books|slice:":50" %}
    <a href="{% url 'book:book_detail' book.id %}" class="rank-card">
      <div class="rank-badge">{{ forloop.counter }}</div>
      <div class="rank-thumb">
        {% if book.cover_img %}
          <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
        {% else %}
          <div class="rank-placeholder">ğŸ“–</div>
        {% endif %}
      </div>
      <div class="rank-details">
        <h4 class="rank-title">{{ book.name }}</h4>
        <p class="rank-author">{{ book.user.nickname }}</p>
      </div>
      <div class="rank-meta">
        <span class="play-count">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" opacity="0.5">
            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
          </svg>
          {{ book.view_count|default:"0" }}
        </span>
      </div>
    </a>
    {% endfor %}
  </div>
</section>



    <!-- ì‹¤ì‹œê°„ ì¸ê¸° ì°¨íŠ¸ -->
    <section class="content-section" data-section="2">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">ğŸ”¥</span>
          ì‹¤ì‹œê°„ ì¸ê¸° ì°¨íŠ¸
          <span class="live-indicator">LIVE</span>
        </h2>
      </div>

      <div class="ranking-list">
        {% for book in popular_books|slice:":5" %}
        <div class="ranking-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="ranking-item">
            <div class="rank-number rank-{{ forloop.counter }}">{{ forloop.counter }}</div>
            <div class="rank-cover">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="rank-placeholder">ğŸ“–</div>
              {% endif %}
              {% with first_episode=book.contents.first %}
                {% if first_episode and first_episode.audio_file %}
                <button class="preview-audio-btn rank-preview"
                        data-audio="{{ first_episode.audio_file.url }}"
                        data-title="{{ book.name }} - 1í™”"
                        data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                </button>
                {% endif %}
              {% endwith %}
            </div>
            <div class="rank-info">
              <h4 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h4>
              <p class="rank-meta">{{ book.user.nickname }} â€¢ {{ book.genres.all.0.name }}</p>
              {% if book.tags.exists %}
              <p class="book-tags" style="margin-top: 2px; font-size: 0.3em; color: #6366f1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {% for tag in book.tags.all|slice:":5" %}
                  #{{ tag.name }}{% if not forloop.last %} {% endif %}
                {% endfor %}
              </p>
              {% endif %}
            </div>
            <div class="rank-stats">
              <span class="rank-score">â­ {{ book.book_score|default:"0.0" }}</span>
              <span class="rank-change {% if forloop.counter <= 3 %}up{% else %}down{% endif %}">
                {% if forloop.counter <= 3 %}â–²{% else %}â–¼{% endif %}
              </span>
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
    </section>


    <!-- íŠ¸ë Œë”© ì‘í’ˆ ì„¹ì…˜ -->
    {% if trending_books %}
    <section class="content-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">âš¡</span>
          ì§€ê¸ˆ ëœ¨ëŠ” ì‘í’ˆ
          <span class="trending-badge">HOT</span>
        </h2>
      </div>

      <div class="books-grid">
        {% for book in trending_books %}
        <div class="book-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="book-item">
            <div class="book-cover-wrapper">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
              <div class="book-badge trending">ë² ìŠ¤íŠ¸ì…€ëŸ¬</div>
            </div>
            <div class="book-details">
              <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h3>
              <p class="book-meta">
                {{ book.user.nickname }} â€¢<br>
                {% for genre in book.genres.all|slice:":2" %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </p>
              <p class="book-stats">
                â­ {{ book.book_score|default:"0.0" }} â€¢ ğŸ“– {{ book.contents.count }}í™”
              </p>
            </div>
          </a>
          {% with first_episode=book.contents.first %}
            {% if first_episode and first_episode.audio_file %}
            <button class="preview-audio-btn grid-preview"
                    data-audio="{{ first_episode.audio_file.url }}"
                    data-title="{{ book.name }} - 1í™”"
                    data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            {% endif %}
          {% endwith %}
        </div>
        {% endfor %}
      </div>
    </section>
    {% endif %}



    <!-- ì¸ê¸°ìˆëŠ” ì‘ê°€ ì„¹ì…˜ -->
    <section class="content-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">ğŸ‘‘</span>
          ì´ë‹¬ì˜ ì‘ê°€
        </h2>
      </div>

      <div class="featured-authors">
        {% for author in popular_authors %}
        <div class="author-item">
          <div class="author-rank rank-{{ forloop.counter }}">{{ forloop.counter }}</div>
          <div class="author-photo">
            {% if author.user_img %}
              <img src="{{ author.user_img.url }}" alt="{{ author.nickname }}" loading="lazy">
            {% else %}
              <div class="author-placeholder">
                {{ author.nickname|slice:":1"|upper }}
              </div>
            {% endif %}
          </div>
          <div class="author-info">
            <h3>{{ author.nickname }}</h3>
            <p>ì‘í’ˆ {{ author.book_count }}ê°œ</p>
          </div>
        </div>
        {% empty %}
        <div class="empty-state">ì•„ì§ ë“±ë¡ëœ ì‘ê°€ê°€ ì—†ìŠµë‹ˆë‹¤</div>
        {% endfor %}
      </div>
    </section>

    <!-- ëœ¨ëˆëœ¨ëˆí•œ ì‹ ì‘ ì„¹ì…˜ -->
    <section class="content-section" id="new-books">
      
      <div class="section-header">
        
        <h2 class="section-title">ëœ¨ëˆëœ¨ëˆí•œ ì‹ ì‘</h2>
                <a href="/new_books/" class="view-more-link">ë”ë³´ê¸° â†’</a>

      </div>




      <div class="books-grid">
        
        {% for book in new_books %}
        <div class="book-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="book-item">
            <div class="book-cover-wrapper">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
            </div>
            <div class="book-details">
              <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h3>
              <p class="book-meta">
                {% for genre in book.genres.all|slice:":2" %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </p>
              {% if book.tags.exists %}
              <p class="book-tags" style="margin-top: 4px; font-size: 0.3em; color: #6366f1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {% for tag in book.tags.all|slice:":5" %}
                  #{{ tag.name }}{% if not forloop.last %} {% endif %}
                {% endfor %}
              </p>
              {% endif %}
            </div>
          </a>
          {% with first_episode=book.contents.first %}
            {% if first_episode and first_episode.audio_file %}
            <button class="preview-audio-btn grid-preview"
                    data-audio="{{ first_episode.audio_file.url }}"
                    data-title="{{ book.name }} - 1í™”"
                    data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            {% endif %}
          {% endwith %}
        </div>
        {% empty %}
        <div class="empty-state">ì•„ì§ ë“±ë¡ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤</div>
        {% endfor %}
      </div>
    </section>


   <!-- ì—í”¼ì†Œë“œ ì—…ë°ì´íŠ¸ -->
    <section class="content-section" id="new-books">
      
      <div class="section-header">
        
        <h2 class="section-title">ë°©ê¸ˆ ì—…ë°ì´íŠ¸ ëœ ì‘í’ˆ</h2>
                <a href="/new_books/" class="view-more-link">ë”ë³´ê¸° â†’</a>

      </div>




      <div class="books-grid">
        
{% for item in latest_episode %}
<div class="book-item-wrapper">
<a href="{% if item.latest_episode %}{% url 'book:content_detail' item.latest_episode.id %}{% else %}{% url 'book:book_detail' item.book.id %}{% endif %}" class="recent-book-card">
    <div class="book-cover-wrapper">
      {% if item.book.cover_img %}
        <img src="{{ item.book.cover_img.url }}" alt="{{ item.book.name }}" loading="lazy">
      {% else %}
        <div class="book-placeholder">
          {{ item.book.name|slice:":2"|upper }}
        </div>
      {% endif %}
    </div>
    <div class="book-details">
      <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ item.book.name }}</h3>
      <p class="book-meta">
        {% for genre in item.book.genres.all|slice:":2" %}
          {{ genre.name }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
      </p>
      {% if item.book.tags.exists %}
      <p class="book-tags" style="margin-top: 4px; font-size: 0.3em; color: #6366f1;">
        {% for tag in item.book.tags.all|slice:":3" %}
          #{{ tag.name }}{% if not forloop.last %} {% endif %}
        {% endfor %}
      </p>
      {% endif %}
    </div>
  </a>

  {% if item.latest_episode and item.latest_episode.audio_file %}
<button class="preview-audio-btn grid-preview"
        data-audio="{{ item.latest_episode.audio_file.url }}"
        data-title="{{ item.book.name }} - {{ item.latest_episode.title }}"
        data-cover="{% if item.book.cover_img %}{{ item.book.cover_img.url }}{% endif %}"
        data-episode-id="{{ item.latest_episode.id }}">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
      <path d="M8 5v14l11-7z"/>
    </svg>
  </button>
  {% endif %}
</div>
{% empty %}
<div class="empty-state">ì•„ì§ ë“±ë¡ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤</div>
{% endfor %}

      </div>
    </section>





    
    <!-- ë§ì¶¤ ì¶”ì²œ ì„¹ì…˜ (ë¡œê·¸ì¸ ìœ ì €ë§Œ) -->
    {% if user.is_authenticated and recommended_books %}
    <section class="content-section recommended-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">ğŸ¯</span>
          {{ user.nickname }}ë‹˜ì„ ìœ„í•œ ì¥ë¥´ ì¶”ì²œ
        </h2>
        <p class="section-subtitle">ë‹¹ì‹ ì´ ì¢‹ì•„í•  ë§Œí•œ ì‘í’ˆë“¤ì´ì—ìš”</p>
      </div>

      <div class="books-grid">
        {% for book in recommended_books %}
        <div class="book-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="book-item">
            <div class="book-cover-wrapper">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
              <div class="book-badge recommended">âœ¨ ì¶”ì²œ</div>
            </div>
            <div class="book-details">
              <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h3>
              <p class="book-meta">
                {{ book.user.nickname }} â€¢ <br>
                {% for genre in book.genres.all|slice:":2" %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </p>
              <p class="book-stats">
                â­ {{ book.book_score|default:"0.0" }} 
              </p>
            </div>
          </a>
          {% with first_episode=book.contents.first %}
            {% if first_episode and first_episode.audio_file %}
            <button class="preview-audio-btn grid-preview"
                    data-audio="{{ first_episode.audio_file.url }}"
                    data-title="{{ book.name }} - 1í™”"
                    data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            {% endif %}
          {% endwith %}
        </div>
        {% endfor %}
      </div>
    </section>
    {% endif %}


    <!-- ë§ì¶¤ ì¶”ì²œ ì„¹ì…˜ (ë¡œê·¸ì¸ ìœ ì €ë§Œ) -->
    {% if user.is_authenticated and ai_recommended_books %}
    <section class="content-section recommended-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">ğŸ¯</span>
          AI ê°€ ì¶”ì²œí•˜ëŠ” ì±…
        </h2>
        <p class="section-subtitle">ë‹¹ì‹ ì´ ì¢‹ì•„í•  ë§Œí•œ ì‘í’ˆë“¤ì´ì—ìš”</p>
      </div>

      <div class="books-grid">
        {% for book in ai_recommended_books %}
        <div class="book-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="book-item">
            <div class="book-cover-wrapper">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
              <div class="book-badge recommended">âœ¨ ì¶”ì²œ</div>
            </div>
            <div class="book-details">
              <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h3>
              <p class="book-meta">
                {{ book.user.nickname }} â€¢<br>
                {% for genre in book.genres.all|slice:":2" %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </p>
              <p class="book-stats">
                â­ {{ book.book_score|default:"0.0" }} 
              </p>
            </div>
          </a>
          {% with first_episode=book.contents.first %}
            {% if first_episode and first_episode.audio_file %}
            <button class="preview-audio-btn grid-preview"
                    data-audio="{{ first_episode.audio_file.url }}"
                    data-title="{{ book.name }} - 1í™”"
                    data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            {% endif %}
          {% endwith %}
        </div>
        {% endfor %}
      </div>
    </section>



<section class="ai-recommend-section">
  <a class="ai-recommend-btn" href="ai_recommended/">
    âœ¨ ì¶”ì²œí•œ ì´ìœ  ë³´ê¸°
  </a>
</section>
    {% endif %}


    {% for item in genres_with_books %}
    <section class="content-section genre-curation-section">
      <div class="section-header">
        <h2 class="section-title">
          <span class="title-icon">ğŸ“š</span>
          {{ item.genre.name }} ì¸ê¸°ì‘
        </h2>
        <a href="{% url 'main:genres_books' item.genre.id %}" class="view-more-link">ë”ë³´ê¸° â†’</a>
      </div>

      <div class="genre-carousel">
        {% for book in item.books %}
        <div class="genre-book-card">
          <a href="{% url 'book:book_detail' book.id %}" class="genre-book-link">
            <div class="genre-book-cover">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
              {% with first_episode=book.contents.first %}
                {% if first_episode and first_episode.audio_file %}
                <button class="preview-audio-btn genre-preview"
                        data-audio="{{ first_episode.audio_file.url }}"
                        data-title="{{ book.name }} - 1í™”"
                        data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
                  <svg width="16" height="16" viewBox="0 0 24 24" >
                    <path d="M8 5v14l11-7z"/>
                  </svg>
                </button>
                {% endif %}
              {% endwith %}
            </div>
            <div class="genre-book-info">
              <h4 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h4>
              <p class="genre-book-author">{{ book.user.nickname }}</p>
              <div class="genre-book-stats">
                <span>â­ {{ book.book_score|default:"0.0" }}</span>
                <span>ğŸ“– {{ book.contents.count }}í™”</span>
              </div>
              {% if book.tags.exists %}
              <p class="book-tags" style="margin-top: 4px; font-size: 0.3em; color: #6366f1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {% for tag in book.tags.all|slice:":5" %}
                  #{{ tag.name }}{% if not forloop.last %} {% endif %}
                {% endfor %}
              </p>
              {% endif %}
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
    </section>
    {% endfor %} 

    <!-- ì¥ë¥´ë³„ ì¸ê¸° ì±… ì„¹ì…˜ (í•„í„° ê¸°ëŠ¥) -->
    <section class="content-section">
      <div class="section-header">
        <h2 class="section-title">ì¥ë¥´ë³„ ì¸ê¸° ì±…</h2>
      </div>

      <!-- ì¥ë¥´ í•„í„° -->
      <div class="genre-filters">
        <button class="genre-filter-btn active" data-genre-id="">ì „ì²´</button>
        {% for genre in genres_list %}
        <button class="genre-filter-btn" data-genre-id="{{ genre.id }}">{{ genre.name }}</button>
        {% endfor %}
      </div>

      <div class="books-grid" id="genreBooks" data-filter-url="{% url 'main:filter_books' %}">
        {% for book in popular_books %}
        <div class="book-item-wrapper">
          <a href="{% url 'book:book_detail' book.id %}" class="book-item">
            <div class="book-cover-wrapper">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="book-placeholder">
                  {{ book.name|slice:":2"|upper }}
                </div>
              {% endif %}
            </div>
            <div class="book-details">
              <h3 style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{ book.name }}</h3>
              <p class="book-meta">
                {% for genre in book.genres.all|slice:":2" %}
                  {{ genre.name }}{% if not forloop.last %}, {% endif %}
                {% endfor %}
              </p>
              {% if book.tags.exists %}
              <p class="book-tags" style="margin-top: 4px; font-size: 0.3em; color: #6366f1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                {% for tag in book.tags.all|slice:":5" %}
                  #{{ tag.name }}{% if not forloop.last %} {% endif %}
                {% endfor %}
              </p>
              {% endif %}
            </div>
          </a>
          {% with first_episode=book.contents.first %}
            {% if first_episode and first_episode.audio_file %}
            <button class="preview-audio-btn grid-preview"
                    data-audio="{{ first_episode.audio_file.url }}"
                    data-title="{{ book.name }} - 1í™”"
                    data-cover="{% if book.cover_img %}{{ book.cover_img.url }}{% endif %}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 5v14l11-7z"/>
              </svg>
            </button>
            {% endif %}
          {% endwith %}
        </div>
        {% empty %}
        <div class="empty-state">ì•„ì§ ë“±ë¡ëœ ì‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤</div>
        {% endfor %}
      </div>
    </section>



  </div>
</div>
<!-- í•˜ë‹¨ ê³ ì • ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ - Music Platform Style -->
<div id="bottom-audio-player" class="bottom-audio-player hidden">
  <div class="player-track-info">
    <div class="player-cover">
      <img id="player-cover-img" src="" alt="Book Cover" loading="lazy">
      <div class="player-cover-placeholder">ğŸ“–</div>
    </div>
    <div class="player-text-info">
      <div class="player-title" id="player-book-name">ì±… ì´ë¦„</div>
      <div class="player-subtitle">VOXLIBER</div>
    </div>
  </div>

  <div class="player-controls-section">
    <div class="player-controls">
      <button class="control-btn" id="prevBtn" title="ì´ì „">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
        </svg>
      </button>
      <button class="control-btn control-btn-play" id="playPauseBtn" title="ì¬ìƒ/ì¼ì‹œì •ì§€">
        <svg id="playIcon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M8 5v14l11-7z"/>
        </svg>
        <svg id="pauseIcon" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
          <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
        </svg>
      </button>
      <button class="control-btn" id="nextBtn" title="ë‹¤ìŒ">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
        </svg>
      </button>
    </div>

    <div class="player-progress">
      <span class="time-current" id="currentTime">0:00</span>
      <div class="progress-bar-container">
        <div class="progress-bar-bg">
          <div class="progress-bar-fill" id="progressBar"></div>
          <div class="progress-bar-handle" id="progressHandle"></div>
        </div>
      </div>
      <span class="time-total" id="totalTime">0:00</span>
    </div>
  </div>

  <div class="player-volume-section">
    <button class="control-btn" id="volumeBtn" title="ìŒëŸ‰">
      <svg id="volumeIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
      </svg>
    </button>
    <div class="volume-slider">
      <input type="range" id="volumeControl" min="0" max="100" value="80">
    </div>
    <button id="closePlayerBtn" class="control-btn close-btn" title="ë‹«ê¸°">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
      </svg>
    </button>
  </div>

  <audio id="miniAudio" style="display: none;" loading="lazy"></audio>
</div>


<!-- Footer -->
<footer class="main-footer">
  <div class="footer-container">
    <div class="footer-grid">
      <!-- ë¸Œëœë“œ -->
      <div class="footer-brand">
        <h2>VOXLIBER</h2>
        <p>AI ê¸°ìˆ ë¡œ ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ìƒìƒí•œ ì˜¤ë””ì˜¤ë¶ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ìƒˆë¡œìš´ ë…ì„œ ê²½í—˜ì„ ì‹œì‘í•˜ì„¸ìš”.</p>
        <div class="footer-social">
          <a href="#" class="social-icon">ğŸ“˜</a>
          <a href="#" class="social-icon">ğŸ¦</a>
          <a href="#" class="social-icon">ğŸ“·</a>
          <a href="#" class="social-icon">ğŸ’¼</a>
        </div>
      </div>

      <!-- ì„œë¹„ìŠ¤ -->
      <div class="footer-links">
        <h3>ì„œë¹„ìŠ¤</h3>
        <ul>
          <li><a href="/book/book-snap/">SNAP</a></li>
          <li><a href="/book/author-dashboard/">ì‘ê°€ ì„¼í„°</a></li>
          <li><a href="#">ìš”ê¸ˆì œ</a></li>
        </ul>
      </div>

      <!-- ê³ ê° ì§€ì› -->
      <div class="footer-links">
        <h3>ê³ ê° ì§€ì›</h3>
        <ul>
          <li><a href="faq/">FAQ</a></li>
          <li><a href="notice/">ê³µì§€ì‚¬í•­</a></li>
          <li><a href="contact/">ë¬¸ì˜í•˜ê¸°</a></li>
        </ul>
      </div>

      <!-- ë²•ì  ì •ë³´ -->
      <div class="footer-links">
        <h3>ë²•ì  ì •ë³´</h3>
        <ul>
          <li><a href="terms_of_service/">ì´ìš©ì•½ê´€</a></li>
          <li><a href="privacy_policy/">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
          <li><a href="copyright_policy/">ì €ì‘ê¶Œ ì •ì±…</a></li>
          <li><a href="youth_protection/">ì²­ì†Œë…„ ë³´í˜¸ì •ì±…</a></li>
        </ul>
      </div>
    </div>

    <!-- <div class="footer-bottom">
      <p>Â© 2025 VOXLIBER. All rights reserved.</p>
      <p>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 123-45-67890 | ëŒ€í‘œ: í™ê¸¸ë™ | ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123</p>
    </div> -->
  </div>
</footer>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/home/main.js' %}"></script>
<script src="{% static 'js/common/login_btn.js' %}"></script>

<script>
  
// ìµœê·¼ ì²­ì·¨ ê¸°ë¡ - ì´ì–´ë“£ê¸° ê¸°ëŠ¥
document.addEventListener("DOMContentLoaded", function() {
  // 1. ì¬ìƒ ìœ„ì¹˜ ì‹œê°„ í¬ë§·íŒ… í‘œì‹œ
  const resumeTimeElements = document.querySelectorAll(".resume-time");
  resumeTimeElements.forEach(function(elem) {
    const seconds = parseFloat(elem.dataset.seconds);
    if (seconds && !isNaN(seconds)) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      elem.textContent = mins + "ë¶„ " + secs + "ì´ˆ";
    }
  });

  // 2. ì´ì–´ë“£ê¸° ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
  const resumePlayBtns = document.querySelectorAll(".resume-play-btn");
  resumePlayBtns.forEach(function(btn) {
    btn.addEventListener("click", function(e) {
      e.preventDefault();
      e.stopPropagation();

      const contentUrl = this.dataset.contentUrl;
      const position = parseFloat(this.dataset.position);

      // ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì¬ìƒ ìœ„ì¹˜ ì €ì¥
      if (contentUrl && position) {
        sessionStorage.setItem("resumePosition", position);
        // ì½˜í…ì¸  í˜ì´ì§€ë¡œ ì´ë™
        window.location.href = contentUrl;
      }
    });
  });
});
</script>
{% endblock %}
