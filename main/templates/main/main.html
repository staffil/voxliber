{% extends "base.html" %}
{% load static %}

{% block title %}VOXLIBER - AI ì˜¤ë””ì˜¤ë¶ í”Œë«í¼{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home/main/audio.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/banner.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/common.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/main.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/poem.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/ranking.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/recent.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/resume.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/snap.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/snippet.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/spotlight.css' %}">
<link rel="stylesheet" href="{% static 'css/home/main/genres.css' %}">

<style>
/* ============================================================
   VOXLIBER â€” NEW MAIN PAGE STYLES
   ê¸°ì¡´ ë””ìì¸ ì‹œìŠ¤í…œ (Poppins + --primary/--bg-secondary)ê³¼
   ì™„ì „íˆ í˜¸í™˜ë˜ëŠ” ìƒˆë¡œìš´ ë ˆì´ì•„ì›ƒ
   ============================================================ */

/* â”€â”€ ê³µí†µ ë˜í¼ â”€â”€ */
.vm-page {
  font-family: 'Poppins', sans-serif;
  min-height: 100vh;
  padding-top: 80px;
}

.vm-inner {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 var(--spacing-lg, 24px);
}

/* â”€â”€ Section eyebrow label â”€â”€ */
.vm-eyebrow {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 0.7rem;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--primary, #6366f1);
  margin-bottom: 8px;
}

.vm-eyebrow::before {
  content: '';
  width: 20px;
  height: 2px;
  background: var(--gradient-primary, linear-gradient(135deg, #6366f1, #8b5cf6));
  border-radius: 99px;
}

/* â”€â”€ Section Title â”€â”€ */
.vm-section-title {
  font-size: clamp(1.4rem, 2.5vw, 2rem);
  font-weight: 900;
  color: var(--text-primary);
  letter-spacing: -0.03em;
  line-height: 1.15;
}

.vm-section-title .accent {
  background: var(--gradient-primary, linear-gradient(135deg, #6366f1, #8b5cf6));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* â”€â”€ Section header row â”€â”€ */
.vm-section-header {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 16px;
  flex-wrap: wrap;
  margin-bottom: 28px;
}

.vm-view-more {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--primary, #6366f1);
  border-bottom: 1px solid rgba(99,102,241,0.3);
  padding-bottom: 1px;
  transition: opacity 0.2s;
  white-space: nowrap;
  flex-shrink: 0;
}

.vm-view-more:hover { opacity: 0.65; }

/* ============================================================
   HERO â€” AI ì˜¤ë””ì˜¤ë¶ ì œì‘ ê°•ì¡°
   ============================================================ */
.vm-hero {
  position: relative;
  min-height: 520px;
  display: flex;
  align-items: center;
  padding: 60px 0;
  overflow: hidden;
  margin-bottom: 0;
}

/* ë°°ê²½ ê·¸ë¼ë””ì–¸íŠ¸ ë©”ì‰¬ */
.vm-hero-bg {
  position: absolute;
  inset: 0;
  background:
    radial-gradient(ellipse 65% 55% at 80% 45%, rgba(99,102,241,0.13) 0%, transparent 60%),
    radial-gradient(ellipse 45% 60% at 10% 75%, rgba(139,92,246,0.09) 0%, transparent 55%),
    var(--bg-secondary, #1a1a2e);
  pointer-events: none;
}

/* ë°°ê²½ ê²©ì íŒ¨í„´ */
.vm-hero-grid {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size: 52px 52px;
  mask-image: radial-gradient(ellipse 60% 50% at 50% 50%, black, transparent);
  pointer-events: none;
}

body.light-mode .vm-hero-bg {
  background:
    radial-gradient(ellipse 65% 55% at 80% 45%, rgba(99,102,241,0.07) 0%, transparent 60%),
    #f0f0ff;
}
body.light-mode .vm-hero-grid {
  background-image:
    linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
}

.vm-hero-content {
  position: relative;
  z-index: 2;
  max-width: 660px;
}

/* ìƒë‹¨ ë±ƒì§€ */
.vm-hero-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: rgba(99,102,241,0.12);
  border: 1px solid rgba(99,102,241,0.28);
  border-radius: 99px;
  padding: 6px 16px;
  font-size: 0.72rem;
  font-weight: 700;
  color: #a5b4fc;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  margin-bottom: 24px;
}

body.light-mode .vm-hero-badge {
  background: rgba(99,102,241,0.08);
  color: #6366f1;
}

.vm-hero-badge-dot {
  width: 6px; height: 6px;
  background: #6366f1;
  border-radius: 50%;
  box-shadow: 0 0 8px #6366f1;
  animation: vmPulse 2s ease infinite;
}

@keyframes vmPulse {
  0%,100% { opacity:1; transform:scale(1); }
  50%      { opacity:.35; transform:scale(.65); }
}

/* íˆì–´ë¡œ íƒ€ì´í‹€ */
.vm-hero-title {
  font-size: clamp(2.2rem, 5.5vw, 4.2rem);
  font-weight: 900;
  line-height: 1.05;
  letter-spacing: -0.04em;
  color: var(--text-primary);
  margin-bottom: 20px;
}

.vm-hero-title .grd {
  background: var(--gradient-primary, linear-gradient(135deg, #6366f1, #a78bfa));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

body.light-mode .vm-hero-title { color: #0f172a; }

.vm-hero-sub {
  font-size: 1.05rem;
  font-weight: 300;
  color: rgba(255,255,255,0.55);
  line-height: 1.75;
  max-width: 480px;
  margin-bottom: 36px;
}

body.light-mode .vm-hero-sub { color: #64748b; }

/* íˆì–´ë¡œ ë²„íŠ¼ */
.vm-hero-btns {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.vm-btn-main {
  display: inline-flex;
  align-items: center;
  gap: 9px;
  padding: 14px 28px;
  background: var(--gradient-primary, linear-gradient(135deg, #6366f1, #8b5cf6));
  color: #fff;
  font-family: 'Poppins', sans-serif;
  font-size: 0.92rem;
  font-weight: 700;
  border-radius: var(--radius-full, 999px);
  box-shadow: 0 8px 28px rgba(99,102,241,0.42);
  transition: transform 0.22s, box-shadow 0.22s;
  white-space: nowrap;
}

.vm-btn-main:hover {
  transform: translateY(-3px) scale(1.02);
  box-shadow: 0 14px 36px rgba(99,102,241,0.55);
}

.vm-btn-ghost {
  display: inline-flex;
  align-items: center;
  gap: 9px;
  padding: 14px 28px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.14);
  color: rgba(255,255,255,0.8);
  font-size: 0.92rem;
  font-weight: 600;
  border-radius: var(--radius-full, 999px);
  transition: background 0.2s, border-color 0.2s;
  white-space: nowrap;
}

.vm-btn-ghost:hover {
  background: rgba(255,255,255,0.1);
  border-color: rgba(255,255,255,0.25);
}

body.light-mode .vm-btn-ghost {
  background: rgba(0,0,0,0.04);
  border-color: rgba(0,0,0,0.12);
  color: #374151;
}

/* íˆì–´ë¡œ í†µê³„ */
.vm-hero-stats {
  display: flex;
  gap: 36px;
  margin-top: 52px;
  padding-top: 28px;
  border-top: 1px solid rgba(255,255,255,0.07);
  flex-wrap: wrap;
}

body.light-mode .vm-hero-stats { border-top-color: rgba(0,0,0,0.07); }

.vm-stat-num {
  font-size: 1.7rem;
  font-weight: 900;
  background: var(--gradient-primary, linear-gradient(135deg,#6366f1,#a78bfa));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: -0.03em;
  line-height: 1;
}

.vm-stat-lbl {
  font-size: 0.68rem;
  font-weight: 600;
  color: rgba(255,255,255,0.35);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin-top: 4px;
}

body.light-mode .vm-stat-lbl { color: #94a3b8; }

/* ë–  ìˆëŠ” ë¶ ì¹´ë“œ (ìš°ì¸¡, ë°ìŠ¤í¬íƒ‘ë§Œ) */
.vm-hero-float {
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  width: 300px;
  padding-right: 0;
  z-index: 2;
}

@media (max-width: 1100px) { .vm-hero-float { display: none; } }

.vm-float-card {
  aspect-ratio: 3/4;
  border-radius: 14px;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.07);
  transition: transform 0.35s;
  background: var(--bg-tertiary, #0f0f1a);
  position: relative;
}

.vm-float-card:hover { transform: translateY(-7px); }
.vm-float-card:nth-child(even) { margin-top: 36px; }

.vm-float-card img {
  width: 100%; height: 100%;
  object-fit: cover;
  opacity: 0.82;
}

.vm-float-card-no-img {
  width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  font-size: 2.2rem;
  background: linear-gradient(135deg, rgba(99,102,241,0.2), rgba(139,92,246,0.15));
}

.vm-float-label {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  padding: 10px;
  background: linear-gradient(transparent, rgba(0,0,0,0.8));
  font-size: 0.7rem;
  font-weight: 600;
  line-height: 1.3;
}

/* ============================================================
   HOW IT WORKS
   ============================================================ */
.vm-hiw {
  background: rgba(255,255,255,0.02);
  border-top: 1px solid rgba(255,255,255,0.06);
  border-bottom: 1px solid rgba(255,255,255,0.06);
  padding: 72px 0;
}

body.light-mode .vm-hiw {
  background: rgba(99,102,241,0.03);
  border-color: rgba(99,102,241,0.1);
}

.vm-hiw-steps {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 48px;
  position: relative;
}

.vm-hiw-steps::before {
  content: '';
  position: absolute;
  top: 36px; left: calc(16.6% + 12px);
  width: calc(66.6% - 24px);
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(99,102,241,0.25), transparent);
  pointer-events: none;
}

.vm-hiw-step {
  position: relative;
  padding: 28px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 16px;
  transition: border-color 0.25s, transform 0.25s;
}

body.light-mode .vm-hiw-step {
  background: #fff;
  border-color: rgba(0,0,0,0.07);
  box-shadow: 0 2px 16px rgba(0,0,0,0.05);
}

.vm-hiw-step:hover {
  border-color: rgba(99,102,241,0.3);
  transform: translateY(-4px);
}

.vm-hiw-num {
  font-size: 0.65rem;
  font-weight: 800;
  letter-spacing: 0.12em;
  color: rgba(99,102,241,0.6);
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.vm-hiw-num::after {
  content: '';
  flex: 1;
  height: 1px;
  background: rgba(99,102,241,0.15);
}

.vm-hiw-icon {
  width: 46px; height: 46px;
  border-radius: 12px;
  background: rgba(99,102,241,0.12);
  border: 1px solid rgba(99,102,241,0.2);
  display: flex; align-items: center; justify-content: center;
  font-size: 1.35rem;
  margin-bottom: 16px;
}

.vm-hiw-step h3 {
  font-size: 1rem;
  font-weight: 800;
  color: var(--text-primary);
  margin-bottom: 8px;
}

.vm-hiw-step p {
  font-size: 0.84rem;
  font-weight: 300;
  color: rgba(255,255,255,0.45);
  line-height: 1.7;
}

body.light-mode .vm-hiw-step p { color: #64748b; }

/* ============================================================
   PROMO BANNER
   ============================================================ */
.vm-promo {
  margin: 48px 0;
  border-radius: 18px;
  overflow: hidden;
  position: relative;
  box-shadow: 0 12px 40px rgba(0,0,0,0.3);
}

.vm-promo-track {
  display: flex;
  transition: transform 0.45s cubic-bezier(0.77,0,0.175,1);
}

.vm-promo-slide {
  flex: 0 0 100%;
  height: 240px;
  position: relative;
}

.vm-promo-slide img {
  width: 100%; height: 100%;
  object-fit: cover;
  display: block;
}

.vm-promo-slide-empty {
  width: 100%; height: 240px;
  background: linear-gradient(135deg, rgba(99,102,241,0.15), rgba(139,92,246,0.1));
  display: flex; align-items: center; justify-content: center;
  color: rgba(255,255,255,0.25);
}

.vm-promo-prev, .vm-promo-next {
  position: absolute;
  top: 50%; transform: translateY(-50%);
  width: 36px; height: 36px;
  border-radius: 50%;
  background: rgba(0,0,0,0.5);
  border: 1px solid rgba(255,255,255,0.15);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  z-index: 4;
  transition: background 0.2s;
  color: #fff;
}

.vm-promo-prev:hover, .vm-promo-next:hover { background: rgba(99,102,241,0.7); }
.vm-promo-prev { left: 14px; }
.vm-promo-next { right: 14px; }

.vm-promo-dots {
  position: absolute;
  bottom: 12px; left: 50%; transform: translateX(-50%);
  display: flex; gap: 6px; z-index: 4;
}

.vm-promo-dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: rgba(255,255,255,0.35);
  cursor: pointer;
  transition: background 0.2s, transform 0.2s;
}

.vm-promo-dot.active {
  background: var(--primary, #6366f1);
  transform: scale(1.4);
}

/* ============================================================
   TABS
   ============================================================ */
.vm-tabs-bar {
  position: sticky;
  top: 64px;
  z-index: 90;
  background: var(--bg-secondary, #1a1a2e);
  border-bottom: 1px solid rgba(255,255,255,0.07);
  padding: 0;
}

body.light-mode .vm-tabs-bar {
  background: #f8f8ff;
  border-bottom-color: rgba(0,0,0,0.07);
}

.vm-tabs-inner {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 var(--spacing-lg, 24px);
  display: flex;
  gap: 0;
}

.vm-tab {
  flex: 1;
  max-width: 200px;
  padding: 15px 20px;
  text-align: center;
  font-family: 'Poppins', sans-serif;
  font-size: 0.95rem;
  font-weight: 700;
  color: rgba(255,255,255,0.42);
  cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: color 0.25s, border-color 0.25s;
  user-select: none;
}

body.light-mode .vm-tab { color: rgba(0,0,0,0.38); }

.vm-tab:hover { color: rgba(255,255,255,0.78); }
body.light-mode .vm-tab:hover { color: rgba(0,0,0,0.7); }

.vm-tab.active {
  color: #fff;
  border-bottom-color: var(--primary, #6366f1);
}

body.light-mode .vm-tab.active { color: #0f172a; border-bottom-color: #6366f1; }

.vm-panel { display: none; }
.vm-panel.active { display: block; }

/* ============================================================
   GENRE CHIP FILTERS
   ============================================================ */
.vm-chips {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 28px;
}

.vm-chip {
  padding: 6px 16px;
  border-radius: 99px;
  font-family: 'Poppins', sans-serif;
  font-size: 0.75rem;
  font-weight: 600;
  border: 1px solid rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.5);
  cursor: pointer;
  transition: all 0.2s;
  background: transparent;
}

body.light-mode .vm-chip {
  border-color: rgba(0,0,0,0.1);
  color: rgba(0,0,0,0.45);
}

.vm-chip:hover, .vm-chip.active {
  background: rgba(99,102,241,0.14);
  border-color: rgba(99,102,241,0.38);
  color: #a5b4fc;
}

body.light-mode .vm-chip:hover,
body.light-mode .vm-chip.active {
  color: #6366f1;
  background: rgba(99,102,241,0.08);
  border-color: rgba(99,102,241,0.3);
}

/* ============================================================
   BOOK CARD GRID (ìƒˆ ë””ìì¸, ê¸°ì¡´ .books-gridì™€ ë³„ë„)
   ============================================================ */
.vm-books-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(148px, 1fr));
  gap: 18px;
}

@media (max-width: 480px) {
  .vm-books-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; }
}

.vm-book-card {
  position: relative;
  cursor: pointer;
  transition: transform 0.26s;
}

.vm-book-card:hover { transform: translateY(-6px); }

.vm-book-cover {
  aspect-ratio: 3/4;
  border-radius: 10px;
  overflow: hidden;
  background: var(--bg-tertiary, #0f0f1a);
  border: 1px solid rgba(255,255,255,0.06);
  position: relative;
}

body.light-mode .vm-book-cover {
  border-color: rgba(0,0,0,0.07);
  box-shadow: 0 3px 12px rgba(0,0,0,0.08);
}

.vm-book-cover img {
  width: 100%; height: 100%;
  object-fit: cover;
  transition: transform 0.4s;
}

.vm-book-card:hover .vm-book-cover img { transform: scale(1.06); }

.vm-book-cover-empty {
  width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  font-size: 2.2rem;
  background: linear-gradient(135deg, rgba(99,102,241,0.15), rgba(139,92,246,0.1));
}

.vm-book-genre-pill {
  position: absolute;
  top: 9px; left: 9px;
  background: rgba(0,0,0,0.6);
  border-radius: 99px;
  padding: 3px 9px;
  font-size: 0.62rem;
  font-weight: 700;
  color: rgba(255,255,255,0.88);
  letter-spacing: 0.04em;
}

.vm-book-play-hover {
  position: absolute;
  inset: 0;
  background: linear-gradient(transparent 45%, rgba(0,0,0,0.72));
  border-radius: 10px;
  display: flex;
  align-items: flex-end;
  padding: 12px;
  opacity: 0;
  transition: opacity 0.25s;
}

.vm-book-card:hover .vm-book-play-hover { opacity: 1; }

.vm-play-circle {
  width: 36px; height: 36px;
  border-radius: 50%;
  background: var(--gradient-primary, linear-gradient(135deg, #6366f1, #8b5cf6));
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 16px rgba(99,102,241,0.5);
}

.vm-book-meta { margin-top: 10px; padding: 0 2px; }

.vm-book-name {
  font-size: 0.84rem;
  font-weight: 700;
  color: var(--text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  line-height: 1.3;
}

.vm-book-author {
  font-size: 0.72rem;
  font-weight: 400;
  color: rgba(255,255,255,0.38);
  margin-top: 2px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

body.light-mode .vm-book-author { color: #94a3b8; }

.vm-book-score {
  font-size: 0.69rem;
  font-weight: 600;
  color: #f59e0b;
  margin-top: 4px;
  display: flex;
  align-items: center;
  gap: 3px;
}

/* ============================================================
   RANKING LIST
   ============================================================ */
.vm-rank-list {
  display: flex;
  flex-direction: column;
  gap: 2px;
  margin-top: 28px;
}

.vm-rank-row {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid transparent;
  transition: background 0.2s, border-color 0.2s;
  cursor: pointer;
}

.vm-rank-row:hover {
  background: rgba(255,255,255,0.04);
  border-color: rgba(255,255,255,0.07);
}

body.light-mode .vm-rank-row:hover {
  background: rgba(0,0,0,0.03);
  border-color: rgba(0,0,0,0.06);
}

.vm-rank-num {
  font-size: 1.1rem;
  font-weight: 900;
  width: 28px;
  text-align: center;
  flex-shrink: 0;
  color: rgba(255,255,255,0.25);
}

body.light-mode .vm-rank-num { color: rgba(0,0,0,0.2); }

.vm-rank-num.r1 { background: linear-gradient(135deg,#f59e0b,#fbbf24); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.vm-rank-num.r2 { background: linear-gradient(135deg,#94a3b8,#cbd5e1); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
.vm-rank-num.r3 { background: linear-gradient(135deg,#b45309,#d97706); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }

.vm-rank-thumb {
  width: 48px; height: 64px;
  border-radius: 8px;
  overflow: hidden;
  flex-shrink: 0;
  background: var(--bg-tertiary, #0f0f1a);
}

.vm-rank-thumb img { width: 100%; height: 100%; object-fit: cover; }

.vm-rank-thumb-empty {
  width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.1rem;
}

.vm-rank-info { flex: 1; min-width: 0; }

.vm-rank-title {
  font-size: 0.9rem;
  font-weight: 700;
  color: var(--text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.vm-rank-author {
  font-size: 0.74rem;
  color: rgba(255,255,255,0.38);
  margin-top: 2px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

body.light-mode .vm-rank-author { color: #94a3b8; }

.vm-rank-genre {
  display: inline-block;
  margin-top: 5px;
  padding: 2px 9px;
  border-radius: 99px;
  font-size: 0.65rem;
  font-weight: 700;
  background: rgba(99,102,241,0.12);
  color: #a5b4fc;
}

body.light-mode .vm-rank-genre { background: rgba(99,102,241,0.08); color: #6366f1; }

.vm-rank-score {
  font-size: 0.84rem;
  font-weight: 800;
  color: #f59e0b;
  flex-shrink: 0;
}

/* live badge */
.vm-live-dot {
  display: inline-block;
  width: 7px; height: 7px;
  background: #ef4444;
  border-radius: 50%;
  box-shadow: 0 0 8px #ef4444;
  margin-right: 5px;
  animation: vmPulse 1.5s ease infinite;
}

/* ============================================================
   EPISODE SCROLL STRIP
   ============================================================ */
.vm-ep-strip {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding-bottom: 10px;
  margin-top: 28px;
  scrollbar-width: thin;
  scrollbar-color: rgba(99,102,241,0.3) transparent;
}

.vm-ep-card {
  flex-shrink: 0;
  width: 220px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 14px;
  overflow: hidden;
  transition: border-color 0.25s, transform 0.25s;
}

body.light-mode .vm-ep-card {
  background: #fff;
  border-color: rgba(0,0,0,0.07);
  box-shadow: 0 2px 10px rgba(0,0,0,0.06);
}

.vm-ep-card:hover {
  border-color: rgba(99,102,241,0.3);
  transform: translateY(-4px);
}

.vm-ep-thumb {
  height: 118px;
  overflow: hidden;
  background: var(--bg-tertiary, #0f0f1a);
  position: relative;
}

.vm-ep-thumb img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s; }
.vm-ep-card:hover .vm-ep-thumb img { transform: scale(1.06); }

.vm-ep-thumb-empty {
  width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.8rem;
  background: linear-gradient(135deg, rgba(99,102,241,0.15), rgba(139,92,246,0.1));
}

.vm-ep-new {
  position: absolute;
  top: 8px; right: 8px;
  background: #ef4444;
  color: #fff;
  font-size: 0.58rem;
  font-weight: 800;
  padding: 3px 7px;
  border-radius: 99px;
  letter-spacing: 0.07em;
}

.vm-ep-body { padding: 13px; }

.vm-ep-num {
  font-size: 0.68rem;
  font-weight: 700;
  color: var(--primary, #6366f1);
  margin-bottom: 4px;
}

.vm-ep-title {
  font-size: 0.86rem;
  font-weight: 700;
  color: var(--text-primary);
  line-height: 1.35;
  overflow: hidden;
  text-overflow: ellipsis;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.vm-ep-book {
  font-size: 0.72rem;
  color: rgba(255,255,255,0.35);
  margin-top: 5px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

body.light-mode .vm-ep-book { color: #94a3b8; }

/* ============================================================
   IEODUTKGI (ì´ì–´ë“£ê¸°) â€” Continue Listening
   ============================================================ */
.vm-continue-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
  gap: 14px;
  margin-top: 24px;
}

.vm-continue-card {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 14px;
  transition: border-color 0.22s, transform 0.22s;
  cursor: pointer;
}

body.light-mode .vm-continue-card {
  background: #fff;
  border-color: rgba(0,0,0,0.07);
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.vm-continue-card:hover {
  border-color: rgba(99,102,241,0.3);
  transform: translateY(-2px);
}

.vm-continue-thumb {
  width: 52px; height: 68px;
  border-radius: 8px;
  overflow: hidden;
  flex-shrink: 0;
  background: var(--bg-tertiary, #0f0f1a);
}

.vm-continue-thumb img { width: 100%; height: 100%; object-fit: cover; }
.vm-continue-thumb-empty {
  width: 100%; height: 100%;
  display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
}

.vm-continue-info { flex: 1; min-width: 0; }

.vm-continue-name {
  font-size: 0.82rem;
  font-weight: 700;
  color: var(--text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.vm-continue-ep {
  font-size: 0.69rem;
  color: var(--primary, #6366f1);
  margin-top: 2px;
  font-weight: 600;
}

.vm-continue-time {
  font-size: 0.65rem;
  color: rgba(255,255,255,0.3);
  margin-top: 3px;
}

body.light-mode .vm-continue-time { color: #94a3b8; }

.vm-continue-btn {
  width: 30px; height: 30px;
  border-radius: 50%;
  background: rgba(99,102,241,0.14);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  transition: background 0.2s;
}

.vm-continue-card:hover .vm-continue-btn {
  background: var(--gradient-primary, linear-gradient(135deg,#6366f1,#8b5cf6));
}

/* ============================================================
   CTA STRIP
   ============================================================ */
.vm-cta-strip {
  background: linear-gradient(105deg,
    rgba(99,102,241,0.12) 0%,
    rgba(139,92,246,0.08) 50%,
    rgba(99,102,241,0.05) 100%);
  border: 1px solid rgba(99,102,241,0.2);
  border-radius: 18px;
  padding: 44px 48px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 28px;
  flex-wrap: wrap;
  position: relative;
  overflow: hidden;
}

.vm-cta-strip::after {
  content: '';
  position: absolute;
  top: -80px; right: -80px;
  width: 300px; height: 300px;
  background: radial-gradient(circle, rgba(139,92,246,0.15) 0%, transparent 70%);
  pointer-events: none;
}

body.light-mode .vm-cta-strip {
  background: linear-gradient(105deg, rgba(99,102,241,0.06), rgba(139,92,246,0.04));
  border-color: rgba(99,102,241,0.15);
}

.vm-cta-strip h2 {
  font-size: clamp(1.2rem, 2.2vw, 1.75rem);
  font-weight: 900;
  color: var(--text-primary);
  letter-spacing: -0.02em;
  margin-bottom: 6px;
}

.vm-cta-strip p {
  font-size: 0.88rem;
  font-weight: 300;
  color: rgba(255,255,255,0.48);
  max-width: 400px;
  line-height: 1.6;
}

body.light-mode .vm-cta-strip p { color: #64748b; }

/* ============================================================
   TOP AUTHORS
   ============================================================ */
.vm-authors-strip {
  display: flex;
  gap: 12px;
  overflow-x: auto;
  padding-bottom: 6px;
  margin-top: 28px;
  scrollbar-width: none;
}

.vm-authors-strip::-webkit-scrollbar { display: none; }

.vm-author-pill {
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 16px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.07);
  border-radius: 99px;
  cursor: pointer;
  transition: border-color 0.2s, transform 0.2s;
}

body.light-mode .vm-author-pill {
  background: #fff;
  border-color: rgba(0,0,0,0.08);
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.vm-author-pill:hover {
  border-color: rgba(99,102,241,0.3);
  transform: translateY(-2px);
}

.vm-author-rank {
  font-size: 0.68rem;
  font-weight: 800;
  color: var(--primary, #6366f1);
  min-width: 14px;
}

.vm-author-avatar {
  width: 36px; height: 36px;
  border-radius: 50%;
  overflow: hidden;
  background: rgba(99,102,241,0.12);
  flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.9rem;
  font-weight: 700;
  color: var(--primary, #6366f1);
}

.vm-author-avatar img { width: 100%; height: 100%; object-fit: cover; }

.vm-author-name {
  font-size: 0.84rem;
  font-weight: 700;
  color: var(--text-primary);
  white-space: nowrap;
}

.vm-author-cnt {
  font-size: 0.68rem;
  font-weight: 400;
  color: rgba(255,255,255,0.35);
  margin-top: 1px;
  white-space: nowrap;
}

body.light-mode .vm-author-cnt { color: #94a3b8; }

/* ============================================================
   AI NOVEL PANEL
   ============================================================ */
.vm-ai-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 16px;
}

@media (max-width: 1024px) { .vm-ai-grid { grid-template-columns: repeat(3, 1fr); gap: 12px; } }
@media (max-width: 768px)  { .vm-ai-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; } }

/* ============================================================
   SECTION SPACING
   ============================================================ */
.vm-section {
  padding: 56px 0;
}

.vm-section + .vm-section {
  padding-top: 0;
}

/* ============================================================
   EMPTY STATE
   ============================================================ */
.vm-empty {
  padding: 48px 20px;
  text-align: center;
  color: rgba(255,255,255,0.25);
  font-size: 0.88rem;
  grid-column: 1 / -1;
}

body.light-mode .vm-empty { color: #cbd5e1; }

/* ============================================================
   FOOTER (ê¸°ì¡´ê³¼ ë™ì¼ êµ¬ì¡°, ìƒ‰ìƒë§Œ í†µì¼)
   ============================================================ */
.vm-footer {
  background: var(--bg-primary, #0f0f1a);
  border-top: 1px solid rgba(255,255,255,0.06);
  padding: 56px 0 36px;
  margin-top: 64px;
}

body.light-mode .vm-footer {
  background: #f0f0f8;
  border-top-color: rgba(0,0,0,0.06);
}

.vm-footer-grid {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr;
  gap: 48px;
  margin-bottom: 48px;
}

@media (max-width: 768px) {
  .vm-footer-grid { grid-template-columns: 1fr 1fr; gap: 32px; }
}

@media (max-width: 480px) {
  .vm-footer-grid { grid-template-columns: 1fr; }
}

.vm-footer-brand-name {
  font-size: 1.5rem;
  font-weight: 900;
  background: var(--gradient-primary, linear-gradient(135deg,#6366f1,#a78bfa));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 10px;
  letter-spacing: -0.02em;
}

.vm-footer-brand-desc {
  font-size: 0.83rem;
  font-weight: 300;
  color: rgba(255,255,255,0.38);
  line-height: 1.75;
}

body.light-mode .vm-footer-brand-desc { color: #64748b; }

.vm-footer-col h4 {
  font-size: 0.7rem;
  font-weight: 800;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: rgba(255,255,255,0.28);
  margin-bottom: 14px;
}

body.light-mode .vm-footer-col h4 { color: #94a3b8; }

.vm-footer-col ul {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.vm-footer-col a {
  font-size: 0.83rem;
  font-weight: 400;
  color: rgba(255,255,255,0.45);
  transition: color 0.2s;
}

.vm-footer-col a:hover { color: #a5b4fc; }

body.light-mode .vm-footer-col a { color: #64748b; }
body.light-mode .vm-footer-col a:hover { color: #6366f1; }

.vm-footer-bottom {
  border-top: 1px solid rgba(255,255,255,0.05);
  padding-top: 24px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 10px;
}

body.light-mode .vm-footer-bottom { border-top-color: rgba(0,0,0,0.05); }

.vm-footer-copy {
  font-size: 0.75rem;
  color: rgba(255,255,255,0.22);
}

body.light-mode .vm-footer-copy { color: #94a3b8; }

/* ============================================================
   RESPONSIVE â€” ê³µí†µ
   ============================================================ */
@media (max-width: 768px) {
  .vm-tabs-bar { top: 56px; }
  .vm-hiw-steps { grid-template-columns: 1fr; }
  .vm-hiw-steps::before { display: none; }
  .vm-cta-strip { padding: 28px 24px; }
}

@media (max-width: 480px) {
  .vm-tabs-bar { top: 50px; }
  .vm-books-grid { grid-template-columns: repeat(2,1fr); }
}
</style>
{% endblock %}


{% block content %}
<div class="vm-page">

  <!-- ============================================================
       HERO
       ============================================================ -->
  <section style="position:relative; overflow:hidden;">
    <div class="vm-hero-bg"></div>
    <div class="vm-hero-grid"></div>
    <div class="vm-inner vm-hero">

      <div class="vm-hero-content">
        <div class="vm-hero-badge">
          <span class="vm-hero-badge-dot"></span>
          AI ì˜¤ë””ì˜¤ë¶ í”Œë«í¼
        </div>

        <h1 class="vm-hero-title">
          ëª©ì†Œë¦¬ë¡œ ë“£ëŠ”<br>
          <span class="grd">ë‹¹ì‹ ì˜ ì´ì•¼ê¸°</span>
        </h1>

        <p class="vm-hero-sub">
          ê¸€ì„ ì“°ë©´ AIê°€ ìƒìƒí•œ ìŒì„±ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.<br>
          ëˆ„êµ¬ë‚˜ ì˜¤ë””ì˜¤ë¶ ì‘ê°€ê°€ ë  ìˆ˜ ìˆì–´ìš”.
        </p>

        <div class="vm-hero-btns">
          {% if user.is_authenticated %}
            <a href="{% url 'book:book_tos' %}" class="vm-btn-main">
              <svg width="17" height="17" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
              ì˜¤ë””ì˜¤ë¶ ë§Œë“¤ê¸°
            </a>
          {% else %}
            <a href="#" onclick="openLogin(); return false;" class="vm-btn-main">
              <svg width="17" height="17" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
              ë¬´ë£Œë¡œ ì‹œì‘í•˜ê¸°
            </a>
          {% endif %}
          <a href="#vm-browse" class="vm-btn-ghost">
            <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
            ì‘í’ˆ íƒìƒ‰
          </a>
        </div>

        <div class="vm-hero-stats">
          <div>
            <div class="vm-stat-num">{{ audio_list.count }}+</div>
            <div class="vm-stat-lbl">ë“±ë¡ ì‘í’ˆ</div>
          </div>
          <div>
            <div class="vm-stat-num">AI</div>
            <div class="vm-stat-lbl">ìŒì„± ë³€í™˜</div>
          </div>
          <div>
            <div class="vm-stat-num">âˆ</div>
            <div class="vm-stat-lbl">ì¥ë¥´ ë¬´ì œí•œ</div>
          </div>
        </div>
      </div>

      <!-- ìš°ì¸¡ í”Œë¡œíŒ… ë¶ ì¹´ë“œ (ë°ìŠ¤í¬íƒ‘) -->
      <div class="vm-hero-float">
        {% for book in new_books|slice:":4" %}
        <div class="vm-float-card">
          <a href="{% url 'book:book_detail' book.public_uuid %}">
            {% if book.cover_img %}
              <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
            {% else %}
              <div class="vm-float-card-no-img">ğŸ“–</div>
            {% endif %}
            <div class="vm-float-label">
              {{ book.name|truncatechars:22 }}
            </div>
          </a>
        </div>
        {% endfor %}
      </div>

    </div>
  </section>


  <!-- ============================================================
       HOW IT WORKS
       ============================================================ -->
  <div class="vm-hiw">
    <div class="vm-inner">
      <div class="vm-eyebrow">How it works</div>
      <h2 class="vm-section-title">3ë‹¨ê³„ë¡œ <span class="accent">ì˜¤ë””ì˜¤ë¶ ì™„ì„±</span></h2>

      <div class="vm-hiw-steps">
        <div class="vm-hiw-step">
          <div class="vm-hiw-num">STEP 01</div>
          <div class="vm-hiw-icon">âœï¸</div>
          <h3>ê¸€ì„ ì‘ì„±í•˜ì„¸ìš”</h3>
          <p>ì†Œì„¤, ì—ì„¸ì´, ì‹œ ë“± ì–´ë–¤ í˜•ì‹ì´ë“  ì¢‹ì•„ìš”. ì—ë””í„°ì— ë‚´ìš©ì„ ì…ë ¥í•˜ê±°ë‚˜ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.</p>
        </div>
        <div class="vm-hiw-step">
          <div class="vm-hiw-num">STEP 02</div>
          <div class="vm-hiw-icon">ğŸ¤–</div>
          <h3>AIê°€ ìŒì„±ìœ¼ë¡œ ë³€í™˜</h3>
          <p>ì„ íƒí•œ ëª©ì†Œë¦¬ì™€ ê°ì •ìœ¼ë¡œ AIê°€ ìë™ ìŒì„±ì„ ìƒì„±í•©ë‹ˆë‹¤. ìˆ˜ì‹­ ê°€ì§€ ëª©ì†Œë¦¬ ì¤‘ ê³¨ë¼ë³´ì„¸ìš”.</p>
        </div>
        <div class="vm-hiw-step">
          <div class="vm-hiw-num">STEP 03</div>
          <div class="vm-hiw-icon">ğŸ§</div>
          <h3>ê³µìœ í•˜ê³  ì¦ê¸°ì„¸ìš”</h3>
          <p>ì™„ì„±ëœ ì˜¤ë””ì˜¤ë¶ì„ í”Œë«í¼ì— ê³µê°œí•˜ê±°ë‚˜, ë§í¬ë¡œ ì¹œêµ¬ë“¤ê³¼ ë°”ë¡œ ê³µìœ í•˜ì„¸ìš”.</p>
        </div>
      </div>
    </div>
  </div>




  <!-- ============================================================
       MAIN TABS BAR
       ============================================================ -->
  <div class="vm-tabs-bar">
    <div class="vm-tabs-inner">
      <div class="vm-tab active" data-panel="vm-audiobook">ğŸ§ ì˜¤ë””ì˜¤ë¶</div>
      <div class="vm-tab" data-panel="vm-ai-novel">ğŸŒ™ AI ì†Œì„¤</div>
    </div>
  </div>


  <!-- ============================================================
       PANEL: ì˜¤ë””ì˜¤ë¶
       ============================================================ -->
  <div id="vm-audiobook" class="vm-panel active">

    <!-- ì´ì–´ë“£ê¸° (ë¡œê·¸ì¸) -->
    {% if request.user.is_authenticated and recent_listening %}
    <div class="vm-inner vm-section">
      <div class="vm-eyebrow">ì´ì–´ë“£ê¸°</div>
      <h2 class="vm-section-title">{{ request.user.nickname }}ë‹˜, <span class="accent">ì—¬ê¸°ì„œ ë©ˆì·„ì–´ìš”</span></h2>
      <div class="vm-continue-grid">
        {% for history in recent_listening %}
        <a href="{% url 'book:content_detail' history.content.public_uuid %}" class="vm-continue-card">
          <div class="vm-continue-thumb">
            {% if history.book.cover_img %}
              <img src="{{ history.book.cover_img.url }}" alt="" loading="lazy">
            {% else %}
              <div class="vm-continue-thumb-empty">ğŸ§</div>
            {% endif %}
          </div>
          <div class="vm-continue-info">
            <div class="vm-continue-name">{{ history.book.name }}</div>
            <div class="vm-continue-ep">{{ history.content.number }}í™” Â· {{ history.content.title }}</div>
            <div class="vm-continue-time">{{ history.last_position|floatformat:0 }}ì´ˆ</div>
          </div>
          <div class="vm-continue-btn">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- ì‹ ì‘ ì˜¤ë””ì˜¤ë¶ íƒìƒ‰ (ë¡œê·¸ì¸ ë¶ˆí•„ìš”) -->
    <div id="vm-browse" class="vm-inner vm-section">
      <div class="vm-section-header">
        <div>
          <div class="vm-eyebrow">ì‹ ì‘ ì˜¤ë””ì˜¤ë¶</div>
          <h2 class="vm-section-title">ì§€ê¸ˆ <span class="accent">ì—…ë¡œë“œëœ</span> ì‘í’ˆ</h2>
        </div>
        <a href="#" class="vm-view-more">ì „ì²´ ë³´ê¸° â†’</a>
      </div>

      <div class="vm-chips">
        <div class="vm-chip active" data-genre-id="">ì „ì²´</div>
        {% for genre in genres_list %}
        <div class="vm-chip" data-genre-id="{{ genre.id }}">{{ genre.name }}</div>
        {% endfor %}
      </div>

      <div class="vm-books-grid" id="vmGenreBooks" data-filter-url="{% url 'main:filter_books' %}">
        {% for book in new_books %}
        <div class="vm-book-card">
          <a href="{% url 'book:book_detail' book.public_uuid %}">
            <div class="vm-book-cover">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="vm-book-cover-empty">ğŸ“š</div>
              {% endif %}
              {% if book.genres.all.0 %}
              <div class="vm-book-genre-pill">{{ book.genres.all.0.name }}</div>
              {% endif %}
              <div class="vm-book-play-hover">
                <div class="vm-play-circle">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
                </div>
              </div>
            </div>
            <div class="vm-book-meta">
              <div class="vm-book-name">{{ book.name }}</div>
              <div class="vm-book-author">{{ book.user.nickname }}</div>
              <div class="vm-book-score">
                <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>
                {{ book.book_score|default:"0.0" }}
              </div>
            </div>
          </a>
        </div>
        {% empty %}
        <div class="vm-empty">ì•„ì§ ë“±ë¡ëœ ì‘í’ˆì´ ì—†ì–´ìš”</div>
        {% endfor %}
      </div>
    </div>

    <!-- ì‹¤ì‹œê°„ ì¸ê¸° ì°¨íŠ¸ -->
    <div class="vm-inner vm-section">
      <div class="vm-eyebrow">
        <span class="vm-live-dot"></span>ì‹¤ì‹œê°„ ì¸ê¸° ì°¨íŠ¸
      </div>
      <h2 class="vm-section-title">ì˜¤ëŠ˜ì˜ <span class="accent">TOP 10</span></h2>

      <div class="vm-rank-list">
        {% for book in popular_books|slice:":10" %}
        <a href="{% url 'book:book_detail' book.public_uuid %}" class="vm-rank-row">
          <div class="vm-rank-num {% if forloop.counter == 1 %}r1{% elif forloop.counter == 2 %}r2{% elif forloop.counter == 3 %}r3{% endif %}">{{ forloop.counter }}</div>
          <div class="vm-rank-thumb">
            {% if book.cover_img %}
              <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
            {% else %}
              <div class="vm-rank-thumb-empty">ğŸ“–</div>
            {% endif %}
          </div>
          <div class="vm-rank-info">
            <div class="vm-rank-title">{{ book.name }}</div>
            <div class="vm-rank-author">{{ book.user.nickname }}</div>
            {% if book.genres.all.0 %}
            <div class="vm-rank-genre">{{ book.genres.all.0.name }}</div>
            {% endif %}
          </div>
          <div class="vm-rank-score">â­ {{ book.book_score|default:"0.0" }}</div>
        </a>
        {% empty %}
        <div class="vm-empty">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì´ì—ìš”</div>
        {% endfor %}
      </div>
    </div>

    <!-- ìµœì‹  ì—í”¼ì†Œë“œ -->
    <div class="vm-inner vm-section">
      <div class="vm-section-header">
        <div>
          <div class="vm-eyebrow">ìµœì‹  ì—…ë°ì´íŠ¸</div>
          <h2 class="vm-section-title">ë°©ê¸ˆ <span class="accent">ì˜¬ë¼ì˜¨</span> ì—í”¼ì†Œë“œ</h2>
        </div>
      </div>
      <div class="vm-ep-strip">
        {% for ep in latest_episode %}
        <a href="{% url 'book:content_detail' ep.public_uuid %}" class="vm-ep-card">
          <div class="vm-ep-thumb">
            {% if ep.book.cover_img %}
              <img src="{{ ep.book.cover_img.url }}" alt="" loading="lazy">
            {% else %}
              <div class="vm-ep-thumb-empty">ğŸ§</div>
            {% endif %}
            <div class="vm-ep-new">NEW</div>
          </div>
          <div class="vm-ep-body">
            <div class="vm-ep-num">{{ ep.number }}í™”</div>
            <div class="vm-ep-title">{{ ep.title }}</div>
            <div class="vm-ep-book">{{ ep.book.name }}</div>
          </div>
        </a>
        {% empty %}
        <div class="vm-empty">ìµœì‹  ì—í”¼ì†Œë“œê°€ ì—†ì–´ìš”</div>
        {% endfor %}
      </div>
    </div>

    <!-- ì¥ë¥´ë³„ íë ˆì´ì…˜ -->
    {% for item in genres_with_books %}
    <div class="vm-inner vm-section">
      <div class="vm-section-header">
        <div>
          <div class="vm-eyebrow">ì¥ë¥´ íë ˆì´ì…˜</div>
          <h2 class="vm-section-title"><span class="accent">{{ item.genre.name }}</span> ì¸ê¸°ì‘</h2>
        </div>
        <a href="{% url 'main:genres_books' item.genre.id %}" class="vm-view-more">ë”ë³´ê¸° â†’</a>
      </div>
      <div class="vm-books-grid">
        {% for book in item.books %}
        <div class="vm-book-card">
          <a href="{% url 'book:book_detail' book.public_uuid %}">
            <div class="vm-book-cover">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="vm-book-cover-empty">ğŸ“š</div>
              {% endif %}
              <div class="vm-book-play-hover">
                <div class="vm-play-circle">
                  <svg width="14" height="14" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
                </div>
              </div>
            </div>
            <div class="vm-book-meta">
              <div class="vm-book-name">{{ book.name }}</div>
              <div class="vm-book-author">{{ book.user.nickname }}</div>
              <div class="vm-book-score">
                <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>
                {{ book.book_score|default:"0.0" }}
              </div>
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endfor %}

    <!-- CTA ìŠ¤íŠ¸ë¦½ -->
    <div class="vm-inner vm-section">
      <div class="vm-cta-strip">
        <div>
          <h2>ë‹¹ì‹ ë„ ì˜¤ë””ì˜¤ë¶ ì‘ê°€ê°€ ë  ìˆ˜ ìˆì–´ìš” âœ¨</h2>
          <p>ê¸€ í•œ í¸ì´ë©´ ì¶©ë¶„í•©ë‹ˆë‹¤. AIê°€ ìŒì„±ê³¼ í¸ì§‘ê¹Œì§€ ë„ì™€ë“œë ¤ìš”.</p>
        </div>
        {% if user.is_authenticated %}
          <a href="{% url 'book:book_tos' %}" class="vm-btn-main">ì§€ê¸ˆ ë§Œë“¤ì–´ë³´ê¸° â†’</a>
        {% else %}
          <a href="#" onclick="openLogin(); return false;" class="vm-btn-main">ë¬´ë£Œë¡œ ì‹œì‘í•˜ê¸° â†’</a>
        {% endif %}
      </div>
    </div>

    <!-- ì´ë‹¬ì˜ ì‘ê°€ -->
    <div class="vm-inner vm-section">
      <div class="vm-eyebrow">ì´ë‹¬ì˜ ì‘ê°€</div>
      <h2 class="vm-section-title">í™œë°œí•œ <span class="accent">í¬ë¦¬ì—ì´í„°</span></h2>
      <div class="vm-authors-strip">
        {% for author in popular_authors %}
        <a href="{% url 'main:user_info' author.public_uuid %}" class="vm-author-pill">
          <div class="vm-author-rank">{{ forloop.counter }}</div>
          <div class="vm-author-avatar">
            {% if author.user_img %}
              <img src="{{ author.user_img.url }}" alt="{{ author.nickname }}" loading="lazy">
            {% else %}
              {{ author.nickname|slice:":1"|upper }}
            {% endif %}
          </div>
          <div>
            <div class="vm-author-name">{{ author.nickname }}</div>
            <div class="vm-author-cnt">ì‘í’ˆ {{ author.book_count }}ê°œ</div>
          </div>
        </a>
        {% empty %}
        <div class="vm-empty">ì‘ê°€ ì •ë³´ ì—†ìŒ</div>
        {% endfor %}
      </div>
    </div>

    <!-- ì¥ë¥´ ê¸°ë°˜ ì¶”ì²œ (ë¡œê·¸ì¸) -->
    {% if user.is_authenticated and recommended_books %}
    <div class="vm-inner vm-section">
      <div class="vm-eyebrow">ë§ì¶¤ ì¶”ì²œ</div>
      <h2 class="vm-section-title">{{ user.nickname }}ë‹˜ì˜ <span class="accent">ì¥ë¥´ ì¶”ì²œ</span></h2>
      <div class="vm-books-grid">
        {% for book in recommended_books %}
        <div class="vm-book-card">
          <a href="{% url 'book:book_detail' book.public_uuid %}">
            <div class="vm-book-cover">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="vm-book-cover-empty">ğŸ“š</div>
              {% endif %}
              <div class="vm-book-play-hover">
                <div class="vm-play-circle"><svg width="14" height="14" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg></div>
              </div>
            </div>
            <div class="vm-book-meta">
              <div class="vm-book-name">{{ book.name }}</div>
              <div class="vm-book-author">{{ book.user.nickname }}</div>
              <div class="vm-book-score"><svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>{{ book.book_score|default:"0.0" }}</div>
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <!-- AI ì¶”ì²œ (ë¡œê·¸ì¸) -->
    {% if user.is_authenticated and ai_recommended_books %}
    <div class="vm-inner vm-section">
      <div class="vm-eyebrow">AI ì¶”ì²œ</div>
      <h2 class="vm-section-title"><span class="accent">AIê°€ ê³ ë¥¸</span> ë§ì¶¤ ì‘í’ˆ</h2>
      <div class="vm-books-grid">
        {% for book in ai_recommended_books %}
        <div class="vm-book-card">
          <a href="{% url 'book:book_detail' book.public_uuid %}">
            <div class="vm-book-cover">
              {% if book.cover_img %}
                <img src="{{ book.cover_img.url }}" alt="{{ book.name }}" loading="lazy">
              {% else %}
                <div class="vm-book-cover-empty">ğŸ“š</div>
              {% endif %}
              <div class="vm-book-play-hover">
                <div class="vm-play-circle"><svg width="14" height="14" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg></div>
              </div>
            </div>
            <div class="vm-book-meta">
              <div class="vm-book-name">{{ book.name }}</div>
              <div class="vm-book-author">{{ book.user.nickname }}</div>
              <div class="vm-book-score"><svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>{{ book.book_score|default:"0.0" }}</div>
            </div>
          </a>
        </div>
        {% endfor %}
      </div>
      <div class="ai-recommend-section" style="margin-top:28px;">
        <a class="ai-recommend-btn" href="ai_recommended/">âœ¨ AI ì¶”ì²œ ì´ìœ  ë³´ê¸°</a>
      </div>
    </div>
    {% endif %}

  </div><!-- /vm-audiobook -->


  <!-- ============================================================
       PANEL: AI ì†Œì„¤
       ============================================================ -->
  <div id="vm-ai-novel" class="vm-panel">
    <div class="vm-inner vm-section">
      <div class="vm-eyebrow">AI Interactive Story</div>
      <h2 class="vm-section-title">AIì™€ í•¨ê»˜ ì“°ëŠ” <span class="accent">ì´ì•¼ê¸°</span></h2>

      <!-- ì„œë¸Œ íƒ­ -->
      <div class="ai-sub-tab-buttons" style="margin-top:24px;">
        <div class="ai-sub-tab-btn active" data-ai-tab="vm-ai-stories">ğŸŒ™ AI Story</div>
        <div class="ai-sub-tab-btn" data-ai-tab="vm-shared-stories">ğŸ“– ê³µìœ í•œ AI ì†Œì„¤</div>
      </div>

      <!-- AI Stories -->
      <div id="vm-ai-stories" class="ai-sub-panel active" style="margin-top:20px;">
        <div class="ai-story-grid">
          {% for story in ai_stories|slice:":30" %}
            {% if story.public_uuid %}
            <div class="ai-story-card">
              <a href="{% url 'character:story_intro' story.public_uuid %}" class="card-link">
                <div class="card-image-box">
                  {% if story.story_desc_video %}
                    <video class="card-image" autoplay loop muted playsinline preload="none"
                           data-src="{{ story.story_desc_video.url }}">
                    </video>
                  {% elif story.cover_image %}
                    <img src="{{ story.cover_image.url }}" alt="{{ story.title }}" class="card-image" loading="lazy">
                  {% else %}
                    <div class="card-placeholder"><span class="placeholder-icon">ğŸŒ™</span></div>
                  {% endif %}
                  <div class="card-gradient-overlay"></div>
                  <div class="card-content">
                    <div class="card-title">{{ story.title }}</div>
                    {% if story.description %}
                    <div class="card-desc">{{ story.description|truncatewords:15 }}</div>
                    {% endif %}
                  </div>
                </div>
              </a>
            </div>
            {% endif %}
          {% empty %}
          <div class="empty-card" style="grid-column:1/-1;">
            <p>ì•„ì§ ë“±ë¡ëœ AI ì†Œì„¤ì´ ì—†ì–´ìš”</p>
            <a href="{% url 'character:make_ai_story' %}" class="empty-btn">ìŠ¤í† ë¦¬ ë§Œë“¤ê¸°</a>
          </div>
          {% endfor %}
        </div>
      </div>

      <!-- ê³µìœ í•œ AI -->
      <div id="vm-shared-stories" class="ai-sub-panel" style="margin-top:20px;">
        <div class="ai-story-grid">
          {% for conv in user_share_list %}
          <div class="ai-story-card">
            <a href="{% url 'main:shared_novel' conv.id %}" class="card-link">
              <div class="card-image-box">
                {% if conv.llm.llm_image %}
                  <img src="{{ conv.llm.llm_image.url }}" alt="{{ conv.llm.name }}" class="card-image" loading="lazy">
                {% else %}
                  <div class="card-placeholder"><span class="placeholder-icon">ğŸ“–</span></div>
                {% endif %}
                <div class="card-gradient-overlay">
                  <div class="user-nickname">
                    {% if conv.user.user_img %}
                      <img src="{{ conv.user.user_img.url }}" alt="{{ conv.user.nickname }}">
                    {% else %}
                      {{ conv.user.nickname|slice:":1"|upper }}
                    {% endif %}
                    <span>{{ conv.user.nickname }}</span>
                  </div>
                </div>
                <div class="card-content">
                  <div class="card-title">{{ conv.merged_audio_title|default:conv.llm.name }}</div>
                  {% if conv.messages.exists %}
                    <div class="card-desc">{{ conv.messages.first.content|truncatechars:40|safe }}</div>
                  {% else %}
                    <div class="card-desc">ì•„ì§ ëŒ€í™”ê°€ ì‹œì‘ë˜ì§€ ì•Šì•˜ì–´ìš”</div>
                  {% endif %}
                </div>
              </div>
            </a>
            <div class="card-meta">ê³µìœ ì: {{ conv.user.nickname|default:'ìµëª…' }} | {{ conv.shared_at|date:"m.d H:i" }}</div>
          </div>
          {% empty %}
          <div class="empty-card" style="grid-column:1/-1;">
            <p>ì•„ì§ ê³µê°œëœ AI ëŒ€í™”ê°€ ì—†ì–´ìš”</p>
            <a href="{% url 'character:make_ai_story' %}" class="empty-btn">ìŠ¤í† ë¦¬ ë§Œë“¤ê¸°</a>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div><!-- /vm-ai-novel -->


  <!-- ============================================================
       FOOTER
       ============================================================ -->
  <footer class="vm-footer">
    <div class="vm-inner">
      <div class="vm-footer-grid">
        <div>
          <div class="vm-footer-brand-name">VOXLIBER</div>
          <p class="vm-footer-brand-desc">AI ê¸°ìˆ ë¡œ ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼<br>ìƒìƒí•œ ì˜¤ë””ì˜¤ë¶ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="vm-footer-col">
          <h4>ì„œë¹„ìŠ¤</h4>
          <ul>
            <li><a href="/book/book-snap/" data-login-required>SNAP</a></li>
            <li><a href="/book/author-dashboard/" data-login-required>ì‘ê°€ ì„¼í„°</a></li>
            <li><a href="#">ìš”ê¸ˆì œ</a></li>
          </ul>
        </div>
        <div class="vm-footer-col">
          <h4>ê³ ê° ì§€ì›</h4>
          <ul>
            <li><a href="faq/">FAQ</a></li>
            <li><a href="notice/">ê³µì§€ì‚¬í•­</a></li>
            <li><a href="contact/" data-login-required>ë¬¸ì˜í•˜ê¸°</a></li>
          </ul>
        </div>
        <div class="vm-footer-col">
          <h4>ë²•ì  ì •ë³´</h4>
          <ul>
            <li><a href="terms/of/service/">ì´ìš©ì•½ê´€</a></li>
            <li><a href="privacy/policy/">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
            <li><a href="copyright/policy/">ì €ì‘ê¶Œ ì •ì±…</a></li>
            <li><a href="youth/protection/">ì²­ì†Œë…„ ë³´í˜¸ì •ì±…</a></li>
          </ul>
        </div>
      </div>
      <div class="vm-footer-bottom">
        <div class="vm-footer-copy">Â© 2025 VOXLIBER. All rights reserved.</div>
      </div>
    </div>
  </footer>

</div><!-- /vm-page -->
{% endblock %}


{% block extra_js %}
<script src="{% static 'js/home/main.js' %}"></script>
<script src="{% static 'js/common/login_btn.js' %}"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {

  /* â”€â”€ ë©”ì¸ íƒ­ â”€â”€ */
  document.querySelectorAll('.vm-tab').forEach(function (tab) {
    tab.addEventListener('click', function () {
      document.querySelectorAll('.vm-tab').forEach(function (t) { t.classList.remove('active'); });
      document.querySelectorAll('.vm-panel').forEach(function (p) { p.classList.remove('active'); });
      tab.classList.add('active');
      var panel = document.getElementById(tab.dataset.panel);
      if (panel) panel.classList.add('active');
    });
  });

  /* â”€â”€ AI ì„œë¸Œ íƒ­ â”€â”€ */
  document.querySelectorAll('.ai-sub-tab-btn').forEach(function (btn) {
    btn.addEventListener('click', function () {
      document.querySelectorAll('.ai-sub-tab-btn').forEach(function (b) { b.classList.remove('active'); });
      document.querySelectorAll('.ai-sub-panel').forEach(function (p) { p.classList.remove('active'); });
      btn.classList.add('active');
      var panel = document.getElementById(btn.dataset.aiTab);
      if (panel) panel.classList.add('active');
    });
  });

  /* â”€â”€ ì¥ë¥´ ì¹© í•„í„° â”€â”€ */
  var vmChips = document.querySelectorAll('.vm-chip[data-genre-id]');
  var vmGrid  = document.getElementById('vmGenreBooks');

  vmChips.forEach(function (chip) {
    chip.addEventListener('click', function () {
      vmChips.forEach(function (c) { c.classList.remove('active'); });
      chip.classList.add('active');

      var gid = chip.dataset.genreId;
      if (!vmGrid) return;

      vmGrid.style.opacity = '0.45';

      fetch((vmGrid.dataset.filterUrl || '') + '?genre_id=' + gid)
        .then(function (r) { return r.json(); })
        .then(function (data) {
          vmGrid.innerHTML = '';
          vmGrid.style.opacity = '1';
          if (!data.books || !data.books.length) {
            vmGrid.innerHTML = '<div class="vm-empty">í•´ë‹¹ ì¥ë¥´ ì‘í’ˆì´ ì—†ì–´ìš”</div>';
            return;
          }
          data.books.forEach(function (book) {
            var card = document.createElement('div');
            card.className = 'vm-book-card';
            card.innerHTML = `
              <a href="/book/${book.public_uuid}/">
                <div class="vm-book-cover">
                  ${book.cover_img
                    ? `<img src="${book.cover_img}" alt="${book.name}" loading="lazy">`
                    : `<div class="vm-book-cover-empty">ğŸ“š</div>`}
                  ${book.genre ? `<div class="vm-book-genre-pill">${book.genre}</div>` : ''}
                  <div class="vm-book-play-hover">
                    <div class="vm-play-circle">
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="white"><path d="M8 5v14l11-7z"/></svg>
                    </div>
                  </div>
                </div>
                <div class="vm-book-meta">
                  <div class="vm-book-name">${book.name}</div>
                  <div class="vm-book-author">${book.author || ''}</div>
                  <div class="vm-book-score">
                    <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01z"/></svg>
                    ${book.book_score || '0.0'}
                  </div>
                </div>
              </a>`;
            vmGrid.appendChild(card);
          });
        })
        .catch(function () { vmGrid.style.opacity = '1'; });
    });
  });

  /* â”€â”€ í”„ë¡œëª¨ ìŠ¬ë¼ì´ë” â”€â”€ */
  var track = document.getElementById('vmPromoTrack');
  var promoDots = document.querySelectorAll('.vm-promo-dot');
  var slideCount = promoDots.length;
  var curSlide = 0;

  function goPromo(idx) {
    curSlide = (idx + slideCount) % slideCount;
    if (track) track.style.transform = 'translateX(-' + (curSlide * 100) + '%)';
    promoDots.forEach(function (d, i) { d.classList.toggle('active', i === curSlide); });
  }

  var prevBtn = document.getElementById('vmPromoPrev');
  var nextBtn = document.getElementById('vmPromoNext');
  if (prevBtn) prevBtn.addEventListener('click', function () { goPromo(curSlide - 1); });
  if (nextBtn) nextBtn.addEventListener('click', function () { goPromo(curSlide + 1); });
  promoDots.forEach(function (dot) {
    dot.addEventListener('click', function () { goPromo(parseInt(dot.dataset.idx)); });
  });
  if (slideCount > 1) {
    setInterval(function () { goPromo(curSlide + 1); }, 4500);
  }

  /* â”€â”€ Lazy video (AI ì¹´ë“œ) â”€â”€ */
  document.querySelectorAll('.ai-story-card video[data-src]').forEach(function (v) {
    var obs = new IntersectionObserver(function (entries, o) {
      if (entries[0].isIntersecting) {
        v.innerHTML = '<source src="' + v.dataset.src + '" type="video/mp4">';
        v.load();
        o.disconnect();
      }
    }, { rootMargin: '200px' });
    obs.observe(v);
  });

});
</script>
{% endblock %}