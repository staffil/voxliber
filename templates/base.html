<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}VOXLIBER{% endblock %}</title>

  {% load static %}
  <link rel="icon" type="image/png" href="{% static 'img/logo3.png' %}">
  <link rel="apple-touch-icon" href="{% static 'img/logo3.png' %}">
  <link rel="stylesheet" href="{% static 'css/common/variables.css' %}">
  {% block extra_css %}{% endblock %}
</head>
<body>

{% if user.is_authenticated %}
  <!-- ë¡œê·¸ì¸ ìƒíƒœ í—¤ë” -->
  <header>
    {% include "common/loginHeader.html" %}

  </header>
    <!-- Mobile Side Menu -->
  <div class="mobile-side-menu" id="mobileSideMenuGuest">
    <div class="mobile-menu-overlay" onclick="closeMobileMenu('Guest')"></div>
    <div class="mobile-menu-content">
      <div class="mobile-menu-header">
        <span class="menu-title">ë©”ë‰´</span>
        <button class="close-menu-btn" onclick="closeMobileMenu('Guest')">âœ•</button>
      </div>

            <!-- Mobile User Profile -->
            <div class="mobile-user-section">
                <a href="{% url 'mypage:my_profile' %}" class="mobile-user-profile">
                    {% if user.user_img %}
                        <img src="{{ user.user_img.url }}" alt="í”„ë¡œí•„" class="mobile-profile-img">
                    {% else %}
                        <img src="{% static 'img/default-avatar.png' %}" alt="í”„ë¡œí•„" class="mobile-profile-img">
                    {% endif %}
                    <div class="mobile-user-info">
                        <div class="mobile-username">{{ user.nickname|default:user.email|default:"ì‚¬ìš©ì" }}</div>
                        <div class="mobile-profile-link">ë§ˆì´í˜ì´ì§€ â†’</div>
                    </div>
                </a>
            </div>

            <nav class="mobile-nav">
                <a href="{% url 'book:book_tos' %}" class="mobile-nav-item">
                    <span class="nav-icon">ğŸ“</span>
                    <span>ì´ì•¼ê¸° ë§Œë“¤ê¸°</span>
                </a>
                <a href="/book/book-snap/" class="mobile-nav-item">
                    <span class="nav-icon">ğŸ“¸</span>
                    <span>SNAP</span>
                </a>
                <a href="/book/author-dashboard/" class="mobile-nav-item">
                    <span class="nav-icon">âœï¸</span>
                    <span>ì‘ê°€ ì„¼í„°</span>
                </a>
                <a href="/mypage/library/" class="mobile-nav-item">
                    <span class="nav-icon">ğŸ“š</span>
                    <span>ë‚´ ì„œì œ</span>
                </a>
                <div class="mobile-menu-divider"></div>
                <a href="{% url 'register:logout' %}" class="mobile-nav-item mobile-logout-btn">
                    <span class="nav-icon">ğŸšª</span>
                    <span>ë¡œê·¸ì•„ì›ƒ</span>
                </a>

            </nav>
        </div>
    </div>

{% else %}
  <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœ í—¤ë” -->
  <header>
    {% include "common/notLoginHeader.html" %}

  </header>

  <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœ ëª¨ë°”ì¼ ë©”ë‰´ -->
  <div class="mobile-side-menu" id="mobileSideMenuGuest">
    <div class="mobile-menu-overlay" onclick="closeMobileMenu('Guest')"></div>
    <div class="mobile-menu-content">
      <div class="mobile-menu-header">
        <span class="menu-title">ë©”ë‰´</span>
        <button class="close-menu-btn" onclick="closeMobileMenu('Guest')">âœ•</button>
      </div>
      <nav class="mobile-nav">
        <a href="#" class="mobile-nav-item" onclick="notLogin()">ğŸ“ ì´ì•¼ê¸° ë§Œë“¤ê¸°</a>
        <a href="/book/book-snap/" class="mobile-nav-item">ğŸ“¸ SNAP</a>
        <a href="#" class="mobile-nav-item">âœï¸ ì‘ê°€ ì„¼í„°</a>
        <div class="mobile-menu-divider"></div>
        <button class="mobile-nav-item mobile-login-btn" onclick="openLogin()">ğŸ”‘ ë¡œê·¸ì¸</button>
      </nav>
    </div>
  </div>
{% endif %}

<!-- í˜ì´ì§€ ì»¨í…ì¸  -->
{% block content %}{% endblock %}

<!-- ê³µí†µ JS -->
<script>
  function notLogin() {
    alert("ë¡œê·¸ì¸ì„ ë¨¼ì € í•´ì£¼ì„¸ìš”.");
    openLogin();
  }

  function toggleTheme() {
    const isLight = document.body.classList.toggle('light-mode');
    localStorage.setItem('theme', isLight ? 'light' : 'dark');
    const themeToggle = document.getElementById('themeToggle');
    if (themeToggle) themeToggle.textContent = isLight ? 'â˜€ï¸' : 'ğŸŒ™';
  }

  (function() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') document.body.classList.add('light-mode');
  })();

  function toggleMobileMenu(type) {
    const menuId = type === 'Logged' ? 'mobileSideMenuLogged' : 'mobileSideMenuGuest';
    const menu = document.getElementById(menuId);
    if (!menu) return; // ë©”ë‰´ê°€ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ì¢…ë£Œ
    menu.classList.toggle('active');
    document.body.style.overflow = menu.classList.contains('active') ? 'hidden' : '';
  }

  function closeMobileMenu(type) {
    const menuId = type === 'Logged' ? 'mobileSideMenuLogged' : 'mobileSideMenuGuest';
    const menu = document.getElementById(menuId);
    menu.classList.remove('active');
    document.body.style.overflow = '';
  }
</script>

{% block extra_js %}{% endblock %}
</body>
</html>
